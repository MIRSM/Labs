<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>
</title>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
</head>
<body background="../FON.JPG" BGCOLOR="#E7E3E7" TEXT="#000000" LINK="#004080" VLINK="#004080">
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Arial, Helvetica, sans-serif">
<a href="Index1.htm">
<img SRC="Back.gif" BORDER="0" width="73" height="22">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Arial, Helvetica, sans-serif">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0" width="73" height="22">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Arial, Helvetica, sans-serif">
<a href="Index3.htm">
<img SRC="For.gif" BORDER="0" width="73" height="22">
</a>
</font>
</td>
</tr>
</table>
<p>
&nbsp;
</p>
<p align="center">
<font face="Arial, Helvetica, sans-serif" size="3">
<font size="4">
Дополнительные режимы адресации&nbsp;
</font>
<br>
</font>
</p>
<p align="left">
<font face="Arial, Helvetica, sans-serif" size="3">

Режимы адресации 32-разрядных 
  процессоров разработаны, исходя из требований образования 32-битового смещения. 
  Другими словами, они предназначены для 32-разрядных приложений, в которых сегменты 
  данных или стека (как, впрочем, и сегменты команд) могут иметь размеры до 2<font size="1">32</font> 
  = 4 Гбайт. Однако в реальном режиме размер любого сегмента ограничивается величиной 
  2<font size="1">16</font> = 64 Кбайт, и 32-битовые смещения не имеют смысла. 
  С другой стороны, ничто не мешает нам использовать для образования 16-битового 
  смещения 32-разрядные регистры (ЕВХ, ESI и проч.), если, конечно, их реальное 
  содержимое не будет превышать величины FFFFh. Указание в качестве операндов 
  команд 32-разрядных регистров позволяет использовать дополнительные возможности 
  32-разрядных процессоров по части адресации памяти, что в некоторых случаях 
  может оказаться полезным. Следует подчеркнуть, что речь идет здесь только о 
  тех операндах, или, правильнее сказать, аргументах команды, которые описывают 
  косвенную (через регистры) адресацию памяти.<br>
  В отличие от МП 86, где базовыми регистрами могут быть только ВХ и ВР, а индексными 
  только SI и DI, 32-разрядные процессоры допускают использование в качестве и 
  базовых, и индексных практически всех регистров общего назначения. Таким образом, 
  вполне законна команда вида
<blockquote>
<p>
  </font><font face="Verdana, Arial, Helvetica, sans-serif" size="3">mov ЕАХ,[ЕСХ][EDX]</font>
</blockquote>
<font face="Arial, Helvetica, sans-serif" size="3">

<p>Второе отличие заключается 
  в возможности масштабирования содержимого индексного регистра, т.е. умножения 
  его на заданный в команде коэффициент, который может принимать значения 1, 2, 
  4 или 8. Пример такой адресации:</p>
  </font>
<blockquote>
<p><font face="Verdana, Arial, Helvetica, sans-serif" size="3">inc word ptr [ЕАХ] [ЕСХ*2]</font>
<font face="Arial, Helvetica, sans-serif" size="3">

<br>
  </p>
  </blockquote>
<p>Еще раз подчеркнем, что 
  дополнительные режимы косвенной адресации требуют использования 32-разрядных 
  регистров. Команды</p>
  <blockquote>
<p>
  </font><font face="Verdana, Arial, Helvetica, sans-serif" size="3">inc word ptr [AX] [ECX*2]<br>
    </font>
  </p>
</blockquote>
<font face="Arial, Helvetica, sans-serif" size="3">

<p>или<br>
 </p>
<blockquote>
<p>
  </font><font face="Verdana, Arial, Helvetica, sans-serif" size="3">inc word ptr [ЕАХ] [СХ*2]</font></p>
</blockquote>
<font face="Arial, Helvetica, sans-serif" size="3">

<p>рассматриваются ассемблером, 
  как неправильные.<br>
  Режимы косвенной адресации памяти, предоставляемые 32-разрядными процессорами 
  при использовании 32-разрядных регистров, изображены на рис. 4.2.<br>
  Из рисунка видно, что в качестве базового можно использовать все регистры общего 
  назначения, включая даже указатель стека
ESP. При этом, если в качестве базового 
  выступает один из регистров ESP или ЕВР, то по умолчанию адресация осуществляется 
  через сегментный регистр SS, хотя возможна замена сегмента. Во всех остальных 
  случаях адресация по умолчанию осуществляется через сегментный регистр
DS. Использование 
  регистра ЕВР в качестве индексного не адресует нас к стеку: адресация попрежнему 
  осуществляется с помощью регистра DS.<br>
 </p>
<p align="center"><img src="gl4-2.jpg" ></p>
<p align="center"><b>Рис. 4.2.</b> Режимы косвенной 
  адресации с использованием 32-разрядных регистров.<br>
</p>
<p>Прочерк во второй колонке 
  подчеркивает, что регистр ESP нельзя использовать в качестве индексного. Это 
  не означает, что ESP нельзя указывать в качестве второго операнда:</p>
<blockquote>
<p>mov ЕАХ,[ЕСХ][ESP]<br>
  </p>
</blockquote>
<p>Недопустима только конструкция, 
  в которой содержимое ESP умножается на масштабирующий множитель:<br>
 </p>
</font>
<blockquote>
<p><font face="Verdana, Arial, Helvetica, sans-serif" size="3">mov ЕАХ,[ЕСХ][ESP*8]<br>
</font>
 </p>
</blockquote>
<font face="Arial, Helvetica, sans-serif" size="3">

<p>Полезно также отметить, 
  что смещение в команде вида<br>
 </p>
<blockquote>
<p></font><font face="Verdana, Arial, Helvetica, sans-serif" size="3">mov ЕАХ,[ЕВХ][ЕСХ]+20</font>
<font face="Arial, Helvetica, sans-serif" size="3">

<br>
 </p>
</blockquote>
<p>может быть только или 8-битовым, 
  или 32-битовым. 16-битовые смещения не образуются. Если указанная в команде 
  величина смещения помещается в байт, как это имеет место в приведенном выше 
  примере команды, то смещение в коде команды занимает 1 байт. Если же величина 
  смещения больше 255, то под него в коде команды отводится сразу 32 бит.<br>
  Таким образом, понятия базовой и индексной адресации в 32-разрядных процессорах 
  несколько размываются. Если регистр указывается с масштабирующим множителем, 
  то это, конечно, индексная адресация. Если же множитель отсутствует, то адресацию 
  и через ЕВХ, и через ESI с равным успехом можно отнести как к базовой, так и 
  к индексной.<br>
  Использование для адресации памяти 16-разрядных регистров резко сужает возможности 
  адресации 32-разрядных процессоров (рис. 4.3). В этом случае мы фактически имеем 
  дело с МП 86.<br>
</p>
<p align="center"><img src="gl4-3.jpg" ></p>
<p align="center"><b>Рис. 4.3. </b> Режимы косвенной 
  адресации с использованием 16-разрядных регистров.<br>
  </p>
<p>Напомним, что в 16-разрядном 
  режиме допустимы не все сочетания базовых и индексных регистров. В качестве 
  базового регистра можно использовать только ВХ или ВР, а в качестве индексного 
  только SI или DI.
</p>
<p>
&nbsp;
</p>
<table COLS="3" WIDTH="16%">
<tr>
<td>
<font face="Arial, Helvetica, sans-serif">
<a href="Index1.htm">
<img SRC="Back.gif" BORDER="0" width="73" height="22">
</a>
</font>
</td>
<td WIDTH="10%">
<font face="Arial, Helvetica, sans-serif">
<a href="../index.html">
<img SRC="Menu.gif" BORDER="0" width="73" height="22">
</a>
</font>
</td>
<td ALIGN="RIGHT">
<font face="Arial, Helvetica, sans-serif">
<a href="Index3.htm">
<img SRC="For.gif" BORDER="0" width="73" height="22">
</a>
</font>
</td>
</tr>
</table>
</font>
</body>
</html>
