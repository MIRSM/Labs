<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 5. Дисковые накопители.</p> <p class="hdr2">Раздел 1. Управление распределением диска.</p> <p class="hdr3">5.1.4 Восстановление после ошибок, связанных с нехваткой пространства на диске.</p> <p> При попытке записи на полный диск может произойти крах программы. Часто легко избежать этого, даже в Бейсике, проверив предварительно наличие дискового пространства {<a href="512.htm">5.1.2</a>}. Однако, если ошибка произошла, то постарайтесь дать пользователю возможность исправить ее. Позвольте ему сохранить только часть данных или стереть какой-нибудь другой файл и повторить попытку. Или, еще более радикальное средство, позвольте пользователю вставить другую дискету. Последний подход должен реализовываться с большой осторожностью. Сначала закройте все открытые файлы. Затем выдайте запрос на смену дискеты. После того, как пользователь сообщит, что новая дискета на месте, создайте новый файл и запишите туда данные. <p> Средний уровень. <p> Все функции DOS, которые пишут на диск, выдают определенный код ошибки при попытке записи на полный диск. Вот сводка этих кодов: <pre class="asm"> 
   Метод доступа  Функция        Hазвание            Kод ошибки 
      FCB          15H      Последовательная запись    AL = 1 
      FCB          22H      Прямая запись              AL = 1 
      FCB          27H      Прямая запись блока        AL = 1 
   Дескриптор      40H      Запись в файл/устройство   CX &lt;&gt; BX 
</pre> 
Проверяйте эти ошибочные условия после каждой записи на диск. Поскольку критической ошибки не происходит, то восстановление не вызывает проблем. Hадо только проверять на ошибку каждый раз когда Вы вызываете одну из этих функций и создать хорошую процедуру обработки ошибок по Вашему вкусу. <hr><p align="center">
<~-<a href="512.htm">5.1.3 Получение/установка размера файла.</a><br><a href="index.htm#header">Содержание</a><br><a href="520.htm">Раздел 2. Работа с каталогами диска.</a>-~>
</p></body></html>
