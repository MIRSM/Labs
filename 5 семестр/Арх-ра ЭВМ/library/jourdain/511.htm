<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 5. Дисковые накопители.</p> <p class="hdr2">Раздел 1. Управление распределением диска.</p> <p class="hdr3">5.1.2 Определение доступного дискового пространства.</p> <p> Хотя в следующем подразделе объянено как восстановить ситуацицию при ошибке из-за нехватки места на диске, но нет лучшего лекарства, чем предусмотрительность. Программа должна контролировать доступное дисковое пространство и сообщать пользователя о нехватке места. Если места не хватает, то пользователь может выйти из программы и устранить проблему без потери информации. <p> Средний уровень. <p> Функция 36H прерывания 21H сообщает сколько имеется свободного пространства на диске. Единственный входной регистр DL, который должен содержать номер накопителя. Hакопитель по умолчанию обозначается 0, накопитель A - 1 и т.д. При возврате BX содержит число доступных кластеров, AX - число секторов в кластере, а CX количество байт в секторе. Hебольшое упражнение в умножении дает желаемый результат. В следующем примере проверяется, что на двухсторонней дискете осталось по меньшей мере 2K дискового пространства: <table align="center"> <tr><td>MOV AH,36H </td><td>;номер функции</td></tr> <tr><td>MOV DL,1 </td><td>;накопитель A</td></tr> <tr><td>INT 21H </td><td>;получаем информацию</td></tr> <tr><td>CMP BX,2 </td><td>;имеется ли 2 свободных кластера?</td></tr> <tr><td>JL RUNNING_OUT </td><td>;если нет, то сообщаем об этом</td></tr> </table> <hr><p align="center">
<~-<a href="510.htm">Глава 5. Дисковые накопители.</a><br><a href="index.htm#header">Содержание</a><br><a href="512.htm">5.1.3 Получение/установка размера файла.</a>-~>
</p></body></html>
