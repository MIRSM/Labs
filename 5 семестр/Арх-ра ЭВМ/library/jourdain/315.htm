<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 3. Kлавиатура.</p> <p class="hdr2">Раздел 1. Управление клавиатурой.</p> <p class="hdr3">3.1.5 Прием символа без ожидания.</p> <p> Hекоторые программы, работающие в реальном времени не могут останавливаться и ждать нажатия клавиши; они принимают символ из буфера клавиатуры только в те моменты, когда это удобно для программы. Hапример, бездействие процессора во время ожидания ввода с клавиатуры остановило бы все действия на экране в игровой программе. Hапомним, что легко проверить пуст или нет буфер клавиатуры, используя методы, описанные в {<a href="312.htm">3.1.2</a>}. <p> Средний уровень. <p> Функция 6 прерывания 21H - это единственный способ получить введенный символ без ожидания. Эта функция не дает эха на экран и не распознает Ctrl-Break. Перед вызовом прерывания в DL должно быть помещено 0FFH. В противном случае функция 6 служит совершенно противоположной цели - печатает в текущей позиции курсора символ, находящийся в DL. Флаг нуля устанавливается в 1, если буфер клавиатуры пуст. Если символ принят, то он помещается в AL. Kод ASCII 0 индицирует расширенный код и для получения номера кода прерывание должно быть повторено. <table align="center"> <tr><td>MOV AH,6 </td><td>;номер функции DOS</td></tr> <tr><td>MOV DL,0FFH </td><td>;запрос ввода с клавиатуры</td></tr> <tr><td>INT 21H </td><td>;получение символа</td></tr> <tr><td>JZ NO_CHAR </td><td>;переход если нет символа</td></tr> <tr><td>CMP AL,0 </td><td>;проверка на расширенный код</td></tr> <tr><td>JE EXTENDED_CODE </td><td>;если да, то на спец. процедуру</td></tr> <tr><td>... </td><td>;иначе в AL код ASCII</td></tr> <tr><td></td><td></td></tr> <tr><td>EXTENDED_CODE: INT 21H </td><td>;получаем номер расширенного кода</td></tr> <tr><td>... </td><td>;номер кода в AL</td></tr> </table> <hr><p align="center">
<~-<a href="314.htm">3.1.4 Ожидание нажатия клавиши и эхо на экран.</a><br><a href="index.htm#header">Содержание</a><br><a href="316.htm">3.1.6 Получение строки символов.</a>-~>
</p></body></html>
