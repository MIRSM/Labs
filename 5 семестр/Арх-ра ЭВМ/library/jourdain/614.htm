<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 6. Принтер.</p> <p class="hdr2">Раздел 1. Управление работой принтера.</p> <p class="hdr3">6.1.4 Переключение между двумя или несколькими принтерами.</p> <p> Kомпьютеры, оснащенные несколькими параллельными портами могут иметь одновременно подсоединенными два или более принтеров. Вывод может перенаправляться с одного принтера на другой двумя способами. Один способ состоит в том, чтобы использовать только такие операторы вывода на печать, которые указывают на какой принтер надо осуществлять вывод. Вы можете написать такой код, который позволит Вам изменять спецификацию. <p> Второй способ переключения принтеров состоит в использовании вывода по умолчанию на LPT1, но указания другого принтера, который будет использоваться в качестве LPT1. Это достигается изменением базового адреса, относящегося к LPT1. Этот базовый адрес хранится в области данных BIOS в ячейке 0040:0008. Поменяйте его с базовым адресом для LPT2 или 3 (хранящимися в ячейках 0040:000A и 0040:000C) и в качестве LPT1 будет использоваться другой адаптер. <p> Hизкий уровень. <p> Один способ, которым программа на ассемблере может изменить принтер, на который она посылает данные, состоит в использовании для печати только функции 0 прерывания 17H {<a href="631.htm">6.3.1</a>}. Эта функция требует, чтобы номер принтера был помещен в DX. Заведите переменную для этого номера, с тем чтобы он мог быть изменен в любой момент. Вторая возможность состоит в обмене базовых адресов LPT1 и LPT2 или LPT3. Следующая программа делает именно это. Kак и все короткие утилиты, она должна писаться в COM форме, как объяснено в {<a href="136.htm">1.3.6</a>}. <table align="center"> <tr><td></td><td>;---обмен базовыми адресами LPT1 и LPT2</td></tr> <tr><td>MOV AX,40H </td><td>;сегмент области данных BIOS</td></tr> <tr><td>MOV ES,AX </td><td>;ES указывает на данные</td></tr> <tr><td>MOV BX,8 </td><td>;смещение для базового адреса LPT1</td></tr> <tr><td>MOV DX,ES:[BX] </td><td>;сохраняем базовый адрес LPT1</td></tr> <tr><td>MOV AX,ES:[BX]+2 </td><td>;сохраняем базовый адрес LPT2</td></tr> <tr><td>MOV ES:[BX],AX </td><td>;меняем базовый адрес LPT2</td></tr> <tr><td>MOV ES:[BX]+2,DX </td><td>;меняем базовый адрес LPT1</td></tr> </table> <hr><p align="center">
<~-<a href="613.htm">6.1.3 Интерпретация ошибок принтера и восстановление после них.</a><br><a href="index.htm#header">Содержание</a><br><a href="620.htm">Раздел 2. Установка спецификаций печати.</a>-~>
</p></body></html>
