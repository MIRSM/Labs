<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 7. Ввод/вывод.</p> <p class="hdr2">Раздел 1. Доступ к последовательному порту.</p> <p class="hdr3">7.1.3 Установка текущего коммуникационного порта.</p> <p> Имеются два способа, которыми программа может определить, какой из коммуникационных портов должен использоваться. Один из способов состоит в указании номера канала в операторе программы. Второй способ состоит в написании программы для обмена через порт COM1, но изменении коммуникационного адаптера, доступ к которому идет через COM1. <p> Область данных BIOS содержит место для четырех 2-хбайтных переменных, которые содержат базовые адреса коммуникационных каналов (MS DOS поддерживает только первые два из них). Базовый адрес порта это младший из группы адресов портов, через которые можно получить доступ к данному коммуникационному каналу. Базовый адрес для COM1 хранится в ячейке 0040:0000, а для COM2 - в ячейке 0040:0002. Для смены коммуникационных портов надо просто поменять эти два значения. Повторная смена значений приведет к первоначальному назначению портов. <p> Средний уровень. <p> Если программа обращается к коммуникационному порту через прерывание 14H BIOS, то COM порт определяется содержимым DX, которое равно 0 или 1 (для COM1 или COM2). Вместо того, чтобы присваивать DX непосредственное значение, заполняйте его из переменной, которой может быть присвоено значение 0 или 1. Программы, использующие коммуникационные функции 3 и 4 прерывания 21H всегда адресуются к COM1. В этом случае надо поменять базовые адреса: <table align="center"> <tr><td></td><td>;---обмен базовых адресов для COM1 и COM2</td></tr> <tr><td>MOV AX,40H </td><td>;ES указывает на область данных BIOS</td></tr> <tr><td>MOV ES,AX </td><td>;</td></tr> <tr><td>MOV DX,ES:[0] </td><td>;помещаем 1-й базовый адрес в DX</td></tr> <tr><td>MOV AX,ES:[2] </td><td>;помещаем 2-й базовый адрес в AX</td></tr> <tr><td>MOV ES:[0],AX </td><td>;обмениваем адреса</td></tr> <tr><td>MOV ES:[2],DX </td><td>;</td></tr> </table> <hr><p align="center">
<~-<a href="712.htm">7.1.2 Инициализация последовательного порта.</a><br><a href="index.htm#header">Содержание</a><br><a href="714.htm">7.1.4 Определение статуса коммуникационного порта.</a>-~>
</p></body></html>
