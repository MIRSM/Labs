<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 3. Kлавиатура.</p> <p class="hdr2">Раздел 1. Управление клавиатурой.</p> <p class="hdr3">3.1.4 Ожидание нажатия клавиши и эхо на экран.</p> <p> При вводе данных и текста, эхо вводимых символов обычно выдается на экран. При этом такие символы как возврат каретки или забой переводятся в соответствующие перемещения курсора, а не изображаются как ASCII символы для этих кодов. Выдача эха происходит в той позиции, где предварительно был установлен курсор и текст автоматически переносится на следующую строку при достижении конца текущей. Перенос на следующую строку не требует специального кода, поскольку символы помещаются в следующую позицию буферной памяти дисплея, которая представляет из себя одну длинную строку, включающую все 25 строк дисплея. <p> Средний уровень. <p> Функция 1 прерывания 21H ожидает ввода символа, если буфер клавиатуры пуст, а затем выводит его на экран в текущую позицию курсора. Обрабатывается Ctrl-Break, поэтому может выполняться процедура обработки Ctrl-Break {<a href="328.htm">3.2.8</a>}. Введенный символ возвращается в AL. При вводе расширенного кода AL содержит ASCII 0. Для получения в AL второго байта расширенного кода надо повторить прерывание. <table align="center"> <tr><td></td><td>;---получение введенного символа</td></tr> <tr><td>MOV AH,1 </td><td>;номер функции</td></tr> <tr><td>INT 21H </td><td>;ожидаем нажатия клавиши</td></tr> <tr><td>CMP AL,0 </td><td>;расширенный код?</td></tr> <tr><td>JE EXTENDED_CODE </td><td>;если да, то на спец. процедуру</td></tr> <tr><td>. </td><td>;иначе символ находится в AL</td></tr> <tr><td></td><td></td></tr> <tr><td></td><td>;---процедура обработки расширенных кодов</td></tr> <tr><td>INT 21H </td><td>;получаем в AL номер кода</td></tr> <tr><td>CMP AL,77 </td><td>;проверка на "курсор-вправо"</td></tr> <tr><td>JNE C_R </td><td>;если нет, проверка следующего</td></tr> <tr><td>JMP CURSOR_RIGHT </td><td>;если да, то на процедуру</td></tr> <tr><td>C_R: CMP AL,75 </td><td>;... и т.д.</td></tr> </table> <p> Эта функция полностью игнорирует клавишу &lt;ESC&gt;. Kлавиша табуляции интерпретируется нормально. Kлавиша забой сдвигает курсор на одну позицию влево, но символ, находящийся в этой позиции не стирается. Kлавиша &lt;Enter&gt; вызывает перемещение курсора в первую позицию текущей строки (нет автоматического перевода строки). <hr><p align="center">
<~-<a href="313.htm">3.1.3 Ожидать ввод символа и не выводить его на экран.</a><br><a href="index.htm#header">Содержание</a><br><a href="315.htm">3.1.5 Прием символа без ожидания.</a>-~>
</p></body></html>
