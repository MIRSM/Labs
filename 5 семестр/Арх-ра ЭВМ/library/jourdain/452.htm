<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 4. Вывод на терминал.</p> <p class="hdr2">Раздел 5. Сдвиг экрана и страницы.</p> <p class="hdr3">4.5.2 Сдвиг текстового экрана горизонтально.</p> <p> Горизонтальный сдвиг иногда требуется в специальных программах обработки текста, таких как текстовые редакторы. Операционная система не имеет для этого специальных средств. По этой причине данная задача немного сложнее чем вертикальный сдвиг - но несущественно. Рассмотрим случай, когда Вы хотите, чтобы экран сдвигался влево на 5 позиций. При этом левые 5 столбцов исчезнут, весь остальной текст сдвигается влево, а самые правые 5 столбцов должны быть очищены. Поскольку видеобуфер представляет из себя одну длинную строку, то если каждый символ буфера сдвинуть на 10  байтов вниз, то суммарный эффект будет состоять в том, что самые левые 5 символов каждой строки будут передвинуты в последние 5 позиций предыдущей строки. Таким образом, весь экран будет сдвинут влево на 5 позиций, передвигая 5 ненужных столбцов в правую часть экрана. Все что после остается - это очистить правые 5 столбцов. Это легко делается с помощью процедуры вертикального сдвига {<a href="451.htm">4.5.1</a>}, которая может выполняться для любой части экрана и которая очищает указанную область если указать сдвиг на 0 строк. <p> Hизкий уровень. <p> В этом примере осуществляется сдвиг на 5 позиций влево. Легко изменить его для сдвига вправо или для другого значения позиций сдвига. При использовании прямого отображения в память этот метод дает практически моментальный сдвиг экрана. <table align="center"> <tr><td></td><td>;---сдвигаем все вниз на 10 байтов</td></tr> <tr><td>MOV AX,0B000H </td><td>;указываем на буфер монохромного</td></tr> <tr><td>MOV ES,AX </td><td>;дисплея</td></tr> <tr><td>MOV DS,AX </td><td>;</td></tr> <tr><td>MOV SI,10 </td><td>;сдвигаем из SI ... </td></tr> <tr><td>MOV DI,0 </td><td>;... в DI</td></tr> <tr><td>MOV CX,1995 </td><td>;сдвигаем все кроме последних 5 байт</td></tr> <tr><td>REP MOVSW </td><td>;осуществляем сдвиг</td></tr> <tr><td></td><td>;---очищаем правый край</td></tr> <tr><td>MOV AH,6 </td><td>;функция вертикального сдвига</td></tr> <tr><td>MOV AL,0 </td><td>;сдвиг на 0 строк чистит окно</td></tr> <tr><td>MOV CH,0 </td><td>;строка левого верхнего угла</td></tr> <tr><td>MOV CL,75 </td><td>;столбец левого верхнего угла</td></tr> <tr><td>MOV DH,24 </td><td>;строка правого нижнего угла</td></tr> <tr><td>MOV DL,79 </td><td>;столбец правого нижнего угла</td></tr> <tr><td>MOV BH,7 </td><td>;атрибут для очищаемых позиций</td></tr> <tr><td>INT 10H </td><td>;чистим окно</td></tr> </table> <hr><p align="center">
<~-<a href="451.htm">4.5.1 Вертикальный сдвиг текстового экрана.</a><br><a href="index.htm#header">Содержание</a><br><a href="453.htm">4.5.3 Переключение между текстовыми страницами.</a>-~>
</p></body></html>
