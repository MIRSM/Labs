<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 5. Дисковые накопители.</p> <p class="hdr2">Раздел 2. Работа с каталогами диска.</p> <p class="hdr3">5.2.2 Создание/удаление подкаталога.</p> <p> Программа может создавать или удалять подкаталоги, при выполнении некоторых условий. Для создания подкаталога необходимо, чтобы было по крайней мере одно пустое место в корневом каталоге. Для удаления подкаталога необходимо, чтобы он не содержал файлов или ссылок на другие подкаталоги. Kроме того, Вы не можете удалить подкаталог, который является Вашим текущим каталогом (тот, с которым по умолчанию выполняются все операции над каталогами). Отметим также, что невозможно удалить корневой каталог. <p> Средний уровень. <p> Поскольку управляющие блоки файлов обслуживают только корневой каталог, то для создания или удаления подкаталога надо использовать дескрипторы файлов. Создание подкаталога: <p> DS:DX должны указывать на строку, дающую накопитель и путь к каталогу, в котором должен быть создан подкаталог. Строка должна завершаться байтом ASCII 0. Для открытия подкаталога с именем PRIMATES в корневом каталоге накопителя A: надо записать строку в виде "A:\PRIMATES". Для открытия подкаталога в другом подкаталоге с именем MAMMALS напишите "A:\MAMMALS\PRIMATES". Имя накопителя A: может быть опущено если Вы работаете с накопителем, используемым по умолчанию, и путь может начинаться с текущего каталога. Поместите в AH 39H и выполните прерывание 21H; если указан правильный путь, то будет создан новый каталог. В противном случае будет установлен флаг переноса, а AX будет содержать код ошибки 3 (путь неверен) или 5 (нет доступа). В примере создается подкаталог PRIMATES: <table align="center"> <tr><td></td><td>;---в сегменте данных</td></tr> <tr><td>PATH DB 'A:MAMMALS\PRIMATES',0</td><td></td></tr> <tr><td></td><td></td></tr> <tr><td></td><td>;---создаем подкаталог с именем PRIMATES</td></tr> <tr><td>LEA DX,PATH </td><td>;DS:DX должны указывать на путь</td></tr> <tr><td>MOV AH,39H </td><td>;номер функции</td></tr> <tr><td>INT 21H </td><td>;создаем подкаталог</td></tr> <tr><td>JC ERROR_ROUT </td><td>;обработка ошибок</td></tr> </table> Удаление подкаталога: <p> Для удаления подкаталога надо сформировать строку, в точностью совпадающую с той, которую Вы указывали при создании каталога. Затем поместите в AH 3AH и выполните прерывание 21H. Опять при невыполнении функции в AX будут возвращены коды 3 или 5 (код 5 может указывать, что каталог непустой). <hr><p align="center">
<~-<a href="521.htm">5.2.1 Чтение/изменение корневого каталога.</a><br><a href="index.htm#header">Содержание</a><br><a href="523.htm">5.2.3 Чтение/изменение подкаталога.</a>-~>
</p></body></html>
