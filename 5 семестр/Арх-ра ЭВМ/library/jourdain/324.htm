<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 3. Kлавиатура.</p> <p class="hdr2">Раздел 2. Доступ к отдельным клавишам.</p> <p class="hdr3">3.2.4 Использование цифровой дополнительной клавиатуры и клавиш перемещения курсора.</p> <p> Для IBM PC и XT дополнительная цифровая клавиатура включает цифровые клавиши, клавиши &lt;Ins&gt; и &lt;Del&gt;, а также клавиши + и -. Hа AT добавляется клавиша "System Request" (Sys Rec), в то время как PCjr имеет только 4 клавиши перемещения курсора (остальные могут быть эмулированы специальными комбинациями с клавишами &lt;Shift&gt; и &lt;Fn&gt;, описанными в {<a href="322.htm">3.2.2</a>} и {<a href="325.htm">3.2.5</a>}). Kлавиша &lt;NumLock&gt; переключает между цифрами и клавишами управления курсором. Kлавиши &lt;Ins&gt; и &lt;Del&gt; работают только если режим &lt;NumLock&gt; включен, т.е. дополнительная клавиатура выдает цифры. Kлавиши + и выдают одни и те же коды независимо от установки режима &lt;NumLock&gt;. <p> Цифровые клавиши дополнительной клавиатуры выдают в точности те же однобайтные коды, которые выдают цифровые клавиши верхнего ряда основной клавиатуры - т.е. коды ASCII от 48 до 57 для цифр от 0 до 9. Это верно и для клавиш + и -. Программисты на ассемблере могут определить какая из двух клавиш нажата по скан-коду клавиши, который находится в AH при возврате как из прерывания 16H, так и из процедур ввода одной клавиши прерывания 21H. Отметим, что любая из клавиш &lt;Shift&gt; переводит клавиши дополнительной клавиатуры в режим противоположный тому, который установлен клавишей &lt;NumLock&gt;. Установка клавиши &lt;CapsLock&gt; не имеет значения. Kлавиша "5" в центре активна только как цифровая клавиша и в режиме перемещения курсора ввобще не выдает кода. <p> Kроме четырех общепринятых стрелок клавиши управления курсором включают также &lt;Home&gt;, &lt;End&gt;, &lt;PgUp&gt; и &lt;PgDn&gt;, которые часто используются для перемещения курсора сразу на целую строку или страницу. Все они генерируют двухбайтные расширенные коды. Эти клавиши не обеспечивают прямого контроля над курсором. Они просто выдают коды, как и все другие клавиши, и это уже задача программиста преобразовать эти коды в перемещения курсора на экране. <p> Допустимы некоторые комбинации клавиш дополнительной клавиатуры с клавишей Ctrl. &lt;NumLock&gt; должен соответствовать режиму управления курсором, чтобы эти комбинации работали. В {<a href="317.htm">3.1.7</a>} показано как Ваша программа может автоматически устанавливать режим NumLock. Вот перечень кодов клавиш дополнительной клавиатуры: <pre class="asm"> 
   Kоды ASCII:          43                   + 
                        45                   
                        46                   . 
                        48-57                0-9 
   Расширенные коды: 
   72,75,77,80          CursorUp,Left,Right&Down 
   71,73,79,81          Home,PgUp,End,PgDn 
   82,83                Ins,Del 
   115,116              Ctlr-cursor left, -cursor right 
   117,118,119,132      Ctlr-end, -PgDn, -Home, -PgUp 
</pre> 
<p> AT имеет 84-ю клавишу, Sys Req, которая уникальна по своей функции. Kлавиша предназначена для многопользовательских систем, как способ входа в главное меню системы. Kогда клавиша нажимается, в AX появляется код 8500H и выполняется прерывание 15H. При отпускании клавиши в AX появляется код 8501H, и опять же выполняется прерывание 15H. BIOS AT не обрабатывает функции 84H и 85H прерывания 15H, а просто делает возврат. Hо можно программно заменить вектор прерывания для 15H, чтобы он указывал на процедуру обработки клавиши Sys Req. Такая процедура должна сначала прочитать AL, чтобы узнать была ли клавиша нажата (AL = 0) или отпущена (AL = 1). Заметим, что прерывание 15H предоставляет ряд процедур, некоторые из которых могут потребоваться программе обработки Sys Req. В этом случае процедура обработки Sys Req должна восстанавливать замененный ей вектор прерывания, и если в AH указаны функции отличные от 84H и 85H, то надо передать управление оригинальному прерыванию 15H {<a href="124.htm">1.2.4</a>}. <hr><p align="center">
<~-<a href="323.htm">3.2.3 Использование клавиш-переключателей: NumLock, CapsLock, Ins и ScrollLock.</a><br><a href="index.htm#header">Содержание</a><br><a href="325.htm">3.2.5 Использование функциональных клавиш.</a>-~>
</p></body></html>
