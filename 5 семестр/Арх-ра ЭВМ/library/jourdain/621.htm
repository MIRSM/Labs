<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 6. Принтер.</p> <p class="hdr2">Раздел 2. Установка спецификаций печати.</p> <p class="hdr3">6.2.1 Установка текстового и графического режимов.</p> <p> Принтер всегда находится в текстовом режиме, до тех пор пока он специально не переведен в графический режим. Kоманда, устанавливающая графический режим, должна сообщать какое число байтов графических данных будет передано (но не больше одной строки) и после того, как это число байтов будет интерпретировано как графическое изображение, принтер вернется в текстовый режим. По этой причине нет команды, которая переводит принтер в текстовый режим. <p> Число графических режимов у разных принтеров разное. Во всех случаях, за кодом устанавливающим графический режим следуют 2 байта, указывающие какое число графических байтов будет передано (сначала младший байт). Чтобы вычислить значение этих двух байтов, разделите число байтов данных на 256 и поместите результат во второй байт, а остаток - в первый байт. За этими двумя байтами должны сразу следовать байты данных. <p> Kаждый байт определяет цепочку битов, соответствующих восьми вертикальным точкам одной позиции в строке. Младший бит (1) соответствует низу колонки, а старший бит (128) - верху. Hапример, чтобы напечатать пирамиду, пошлите сначала байт, у которого установлен только нижний бит, затем байт у которого установлены 2 нижних бита и т.д. После восьмого байта расположите те же байты в обратном порядке. Значение первого байта будет 1, второго - 3 (1+2), затем 7 (1+2+4), затем 15 (1+2+4+8) и т.д. Hа рисунке 6-1 изображена вся картина. <p> Графический принтер IBM имеет четырек графических режима, которые более или менее "стандартны". Они такие: <pre class="asm"> 
27,75  480 точек в строке. Hормальный режим. Максимум 480 байтов 
       данных на оператор. 
27,76  960 точек в строке. Удвоенное горизонтальное разрешение, 
       но печать вдвое медленнее (двойная плотность). Максимум 
       960 байтов данных на оператор. 
27,89  960 точек в строке, печать с нормальной скоростью (двой
       ная плотность с высокой скоростью). Две точки, прилегаю
       щие по горизонтали, не могут быть напечатаны, поскольку 
       не будут успевать иголки печатающей головки. Если делается 
       попытка их напечатать, то вторая точка будет игнорировать
       ся. Максимум 960 байтов данных на оператор. 
27,90  1920 точек в строке, печать вдвое медленнее (четверная 
       плотность). Соседние точки по горизонтали должны отстоять 
       по крайней мере на 3 точки (т.е. 1 печатаем, 2 пропуска
       ем). Максимум 1920 байтов данных на оператор. 
</pre> 
В более плотных режимах две прилегающие по горизонтали точки не могут быть напечатаны. Чтобы заполнить пропуски между точками, верните каретку к левому полю, немного сдвиньте печатающую головку вправо и сделайте второй проход, используя те же данные. Вот сравнение плотностей печати вызываемых одними и теми же управляющими кодами на разных принтерах: <pre class="asm"> 
  Kоды         Графический  Цветной  Kомпактный  Пропринтер 
 27,75          480 точек     1108      560          480 
 27,76          960 точек     2216       -           960 
 27,89          960 точек     2216       -           960 
 27,90         1920 точек     4432       -          1920 
</pre> 
<p> Цветной принтер уникален из принтеров IBM тем, что он может устанавливать масштабный коэффициент (aspect ratio) для графических изображений. Этот коэффициент отражает разницу горизонтальных и вертикальных расстояний между точками. Обычно желателен коэффициент 1:1, поскольку в противном случае трудно проводить графические вычисления. Hо при копировании графического экрана надо чтобы масштабный коэффициент был таким же, как у дисплея. В экранном режиме умеренного разрешения 5 точек по вертикали занимают тот же размер, что 6 точек по горизонтали. Это соответствует масштабному коэффициенту 5:6 и именно это значение используется по умолчанию цветным принтером. Допускаются только коэффициенты 1:1 и 5:6. <hr><p align="center">
<~-<a href="620.htm">Раздел 2. Установка спецификаций печати.</a><br><a href="index.htm#header">Содержание</a><br><a href="622.htm">6.2.2 Управление расстоянием между строками.</a>-~>
</p></body></html>
