<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 1. Системные ресурсы.</p> <p class="hdr2">Раздел 3. Управление программами.</p> <p class="hdr3">1.3.3 Использование команд интерфейса с пользователем из программы.</p> <p> Программа может иметь в своем распоряжении полный набор команд интерфейса с пользователем DOS, таких как DIR или CHKDSK. Kогда эти команды используются из программы, загружается и запускается вторая копию COMMAND.COM. Хотя такой подход может сэкономить много усилий при программировании, для его успешной реализации требуется достаточное количество памяти для этой второй копии и Ваша программа может попасть в ловушку если памяти недостаточно. <p> Средний уровень. <p> В этом случае к примеру, приведенному в {<a href="132.htm">1.3.2</a>} нужно добавить командную строку. Обычно она начинается с байта длины строки, затем следует сама командная строка и, наконец, код ASCII 13. При передаче команды COMMAND.COM Вы должны указать /C перед строкой (см. пункт "Вызов вторичного командного процессора" руководства по MS DOS). Вы должны также указать накопитель, на котором находится COMMAND.COM, поместив имя накопителя в начале командной строки. Чтобы вывести каталог накопителя A:, а COMMAND.COM при этом находится на накопителе B:, нужна строка: <pre class="asm"> COMMAND_LINE DB 12,'B: /C DIR A:',13 
</pre> 
<p> Следующий кусочек кода устанавливает адрес командной строки в блок параметров, используемый в примере {<a href="132.htm">1.3.2</a>}: <table align="center"> <tr><td>LEA BX,PARAMETERS </td><td>;получение адреса блока пар-ров</td></tr> <tr><td>MOV AX,OFFSET COMMAND_LINE </td><td>;получение смещения ком. строки</td></tr> <tr><td>MOV [BX]+2,AX </td><td>;пересылка в 1-е 2 байта блока</td></tr> <tr><td>MOV AX,SEG COMMAND_LINE </td><td>;получение сегмента ком. строки</td></tr> <tr><td>MOV [BX]+4,AX </td><td>;пересылка во 2-е 2 байта блока</td></tr> </table> <hr><p align="center">
<~-<a href="132.htm">1.3.2 Запуск одной программы из другой.</a><br><a href="index.htm#header">Содержание</a><br><a href="134.htm">1.3.4 Сохранение программы в памяти после завершения.</a>-~>
</p></body></html>
