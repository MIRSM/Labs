<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 2. Таймеры и звук.</p> <p class="hdr2">Раздел 2. Создание звука.</p> <p class="hdr3">2.2.4 Гудок динамика.</p> <p> Hекоторым программам требуется набор предостерегающих гудков. Их легко создавать на Бейсике, но операционная система не обеспечивает функцию гудка, как таковую, и только косвенно позволяет получать доступ к гудку, который Вы слышите при старте системы. Для изменения тона вся процедура генерации звука должна быть запрограммирована на низком уровне. Для того чтобы гудок соответствовал подаваемому им сигналу необходимо проявить воображение. Для предсказания близкой опасности создайте набор понижающихся тонов {<a href="227.htm">2.2.7</a>} или, если принтер включен, чередуйте гудки динамика компьютера и принтера (вывод кода ASCII 7 на принтер). <p> Средний уровень. <p> Операционная система не предоставляет специальной функции для генерации звука. Hо Вы можете вызвать знакомый гудок просто подавая код ASCII 7 на стандартное устройство вывода (т.е. терминал), используя одну из функций DOS или BIOS. Kод ASCII 7 интерпретируется как управляющий символ "звонок" и он не рисуется на экране. Проще всего использовать функцию 2 прерывания 21H: <table align="center"> <tr><td>MOV AH,2 </td><td>;функция вывода символа на экран</td></tr> <tr><td>MOV DL,7 </td><td>;посылаем код ASCII 7</td></tr> <tr><td>INT 21H </td><td>;динамик гудит</td></tr> </table> <p> Hизкий уровень. <p> Для простого гудка лучше всего подходит метод, основанный на использовании микросхемы интерфейса с периферией 8255 {<a href="111.htm">1.1.1</a>}. Hиже приведен пример, который практически повторяет гудок, который Вы слышите при старте системы. <table align="center"> <tr><td></td><td>;---гудок динамика</td></tr> <tr><td>MOV DX,800 </td><td>;счетчик числа циклов</td></tr> <tr><td>IN AL,61H </td><td>;читаем порт B 8255</td></tr> <tr><td>AND AL,0FEH </td><td>;выключаем бит таймера 8253</td></tr> <tr><td>NEXTCYCLE: OR AL,2 </td><td>;включаем бит динамика</td></tr> <tr><td>OUT 61H,AL </td><td>;посылаем байт в порт B</td></tr> <tr><td>MOV CX,150 </td><td>;длительность первой половины</td></tr> <tr><td>CYCLEUP: LOOP CYCLEUP </td><td>;задержка пока сигнал высокий</td></tr> <tr><td>AND AL,0FDH </td><td>;выключаем бит динамика</td></tr> <tr><td>OUT 61H,AL </td><td>;посылаем байт в порт B</td></tr> <tr><td>CYCLEDOWN: LOOP CYCLEDOWN </td><td>;задержка пока сигнал низкий</td></tr> <tr><td>DEC DX </td><td>;уменьшаем счетчик циклов</td></tr> <tr><td>JNZ NEXTCYCLE </td><td>;повторяем цикл пока DX не 0</td></tr> </table> <hr><p align="center">
<~-<a href="223.htm">2.2.3 Генерация звука одновременно с другими действиями.</a><br><a href="index.htm#header">Содержание</a><br><a href="225.htm">2.2.5 Генерация набора тонов.</a>-~>
</p></body></html>
