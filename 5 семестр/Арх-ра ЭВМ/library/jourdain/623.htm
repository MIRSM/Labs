<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 6. Принтер.</p> <p class="hdr2">Раздел 2. Установка спецификаций печати.</p> <p class="hdr3">6.2.3 Управление движением бумаги.</p> <p> Бумага на принтере передвигается командами перевода строки, вертикальной табуляции и перевода формата. Установкой переключателей на принтере определяется будет ли принтер автоматически переходить на новую страницу при обнаружении перфорации между страницами. Если перфорация не будет пропускаться, то печать может завершиться прямо на вернем краю очередной страницы. Пропуск перфорации оставляет по три пустых строки сверху и снизу каждой страницы. Hа самом деле принтер не распознает перфорацию, вместо этого он считает, что в начальный момент бумага выравнена на начало страницы и считает число переводов строки. Можно программно переопределить установку переключателей, посылая на принтер управляющие коды 27,56, чтобы принтер не делал пропуска перфорации и 27,57, чтобы делал пропуск перфорации. <p> Графический принтер использует код, который определяют число строк, пропускаемых между страницами. Этот код 27,78,n, где n число строк от 1 до 127. Hапример, код 27,78,10 приведет к тому, что принтер будет пропускать по 10 строк. Если межстрочный интервал равен 1/6 дюйма, то 11-тидюймовая страница будет содержать 66 строк и после печати каждых 56-ти строк принтер будет делать пропуск 10-ти строк. Уже Ваша программа должна позаботиться, чтобы в самом начале прогнать бумагу на 5 строк, с тем чтобы 55 строк текста были центрированы на каждой странице. <p> Если используется бумага, размер которой отличается от стандартного 11-тидюймового, то можно изменить длину страницы, с тем чтобы пропуски перфорации происходили в нужном месте и чтобы перевод формата устанавливал бумагу в правильную позицию. Размер страницы может устанавливаться либо числом строк на странице, либо размером в дюймах. Чтобы установить число строк на странице, пошлите код 27,67,n, где n - число строк. Та же последовательность используется и для установки длины страницы в дюймах, за исключением того, что длина страницы записывается в форме 0,n, где n может быть от 1 до 22 дюймов. Для стандартной страницы надо послать команду 27,67,0,11. <hr><p align="center">
<~-<a href="622.htm">6.2.2 Управление расстоянием между строками.</a><br><a href="index.htm#header">Содержание</a><br><a href="624.htm">6.2.4 Управление положением печатающей головки.</a>-~>
</p></body></html>
