<html><head><title>Справочник программиста на персональном компьютере фирмы IBM.Роберт Журден</title> <meta http-equiv="Content-Type" content="text/html; charset=windows-1251"> <link rel=stylesheet type=text/css href=style.css> </head><body> <p class="hdr1">Глава 3. Kлавиатура.</p> <p class="hdr2">Раздел 2. Доступ к отдельным клавишам.</p> <p class="hdr3">3.2.7 Создание макроопределений для отдельных клавиш.</p> <p> Макроопределение - это строка символов, которая будет выводиться при нажатии одной клавиши. Макроопределения могут быть запрограммированы в интерпретаторе Бейсика или на уровне операционной системы для уменьшения печатания. Поскольку строка может содержать управляющие коды, такие как символ возврата каретки (ASCII 13), то одно макроопределение может выполнять целый набор команд. Для ускорения разработки программ, например, можно написать макроопределение, содержащее все необходимые команды, чтобы оттранслировать и скомпоновать определенную программу. <p> Макроопределения, обеспечиваемые Бейсиком, работают как в Бейсиковских программах, так и на командном уровне Бейсика. Hапример, если Вы запрограммировали клавишу, чтобы при ее нажатии выводилось слово "Орангутан", то при нажатии этой клавиши функция INPUT получит всю эту строку, а цикл, включающий INKEY$, последовательно получит девять символов. С другой стороны, макроопределения, созданные на уровне операционной системы, всегда работают на командном уровне DOS, но внутри программ они будут работать только если программа для ввода с клавиатуры использует функции DOS. Поскольку большинство коммерческих программных продуктов используют прерывание BIOS 16H, то для этих программ макроопределения не будут работать. Kонечно, средства для создания макроопределений могут быть вставлены в процедуры ввода с клавиатуры. <p> Средний уровень. <p> В MS DOS макроопределения создаются с помощью метода перепрограммирования клавиш, описанного в {<a href="326.htm">3.2.6</a>}. Единственное отличие в том, что клавише сопоставляется целая строка символов. Строка может быть введена в виде символов, заключенных в кавычки, или в виде кодов или комбинации того и другого. Вот несколько примеров: <table align="center"> <tr><td>27,'["A"</td><td>;"SET"p' ; присваивает SET заглавной A</td></tr> <tr><td>27,'["ASET"p' </td><td>; эквивалентно предыдущему</td></tr> <tr><td>27,'[27</td><td>;"dir";13p' ; присваивает dir&lt;CR&gt; клавише Esc</td></tr> <tr><td>27,'[0</td><td>;59;"copy *.* b:";13p' ;присваивает F1 команду</td></tr> <tr><td>27,'[0</td><td>;68;0;72;0;72;0;72p' ;заставляет F10 сдвинуть курсор на</td></tr> <tr><td></td><td>;три строки вверх</td></tr> </table> <hr><p align="center">
<~-<a href="326.htm">3.2.6 Перепрограммирование отдельных клавиш.</a><br><a href="index.htm#header">Содержание</a><br><a href="328.htm">3.2.8 Создание процедуры обработки Ctrl-Break.</a>-~>
</p></body></html>
