<html>
<head>
<title>Дисковая память</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="stylesheet" href="../images/styles.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<h1 align="center"> Дисковые внешние запоминающие устройства</h1>
<p>Магнитные диски - это запоминаюшие устройства, основу которых составляет вращающаяся 
  пластина с намагничиваемой поверхностью, на которой сохраняется цифровая информация. 
  Для считывания и записи данных в дисководе диска имеются головки считывания-записи. 
  Диски называются также устройствами с произвольным доступом, поскольку головка 
  считывания-записи может быть независимо позиционированна в любое место на диске. 
</p>
<p>Существует два основных вида дисков: гибкий диск (дискета) и жесткий диск.Дискета 
  - это диск, который можно удалить из дисковода. Жесткий диск - несъемный, он 
  фиксирован на дисководе. </p>
<p>Дискеты изготавливаются из гибких материалов и чаще всего бывают 3.5, 5.25 
  и 7 дюймов в диаметре. Информация может записываться на одну или обе стороны. 
  В большинстве случаев у дискет используются обе стороны. Жесткие диски состоят 
  из одной или нескольких пластин, смонтированых на оси, вращаемой небольшим мотором. 
  Для хранения информации каждая пластина покрыта с обеих сторон намагничиваемым 
  материалом. У каждой стороны пластины имеется своя головка считывания-записи. 
  Головки считывания-записи смонтированы на позиционерах, перемещаемых вместе 
  и управляемых с помощью другого мотора. Контроллер диска, соединенный с каждим 
  дисководом проводами, представляет собой плату, которая с помощью электрических 
  сигналов управляет диском и головками считывания-записи. Плата контроллера диска 
  вставляется в разъем на системной плате компьютера и подсоединяется к главной 
  магистрали, по которой ей передаеются сигналы от центрального процессора. Контроллер 
  управляет обменом данных с диском и позиционированием головок считывания-записи. 
</p>
<h3 align="center">Физическая организация данных на диске </h3>
<p> Дисковые дорожки Каждая поверхность диска делится на дорожки , на которые 
  записы вается информация. Перед выполнением операции чтения или записи предназначенная 
  для данного диска головка считывания-записи перемещается к одной из его дорожек. 
  На большинстве гибких дисков размером 5.25 дюйма имеется 40 или 80 дорожек. 
  Такие диски называются дисками с высокой плотностью (high density). </p>
<p>На жестких дисках количество дорожек во много раз больше, чем на гибких , поскольку 
  они имеют твердую поверхность и могут управляться с большей точностью. Если 
  диск состоит из двух и более пластин (пластиной называется вращающаяся поверхность), 
  то для обозначения всех дорожек с одинаковыми номерами используется термин "цилиндр". 
  Дорожки на диске нумеруются с 0 до максимального номера для данного диска. Так 
  же нумеруются и записывающие поверхности пластин диска.</p>
<p> Часто требуется узнать, какую емкость имеет данный диск . Для расчета можно 
  воспользоваться несколькими его характеристиками. </p>
<p>Во-первых , необходимо знать объем данных, которые можно записать на одной 
  дорожке, выражаемый обычно в байтах. Затем необходимо знать число дорожек на 
  одной стороне диска. Полное число дорожек можно определить , умножив плотность 
  дорожек (обычно выражаемую в количестве дорожек на жюйм и обозначаемую tpi, 
  от tracks per inch), на длину рабочей части поверхности, на которой расположены 
  дорожки. Наконец , необходимо знать число используемых для хранения информации 
  поверхностей, которое обычно равно 1 для односторонних и 2 для двусторонних 
  дисков.В случае жесткого диска это число обычно в два раза больше количества 
  пластин. Для вычисления полной емкости диска может быть использована следующая 
  формула:</p>
<p> <b>емкость диска = объем информации на одной дорожке* число дорожек на одной 
  поверхности * число поверхностей.</b></p>
<p> Объем доступного для использования дискового пространства будет на самом деле 
  меньше, из-за накладных расходов, связанные с размещением на диске специальной 
  информации, необходимой при работе с диском. Эта дополнительная информация, 
  записываемая на каждую дорожку, используется в контроллере диска для нахождения 
  требуемой дорожки. </p>
<p> Дорожки , имеющие форму окружности, подразделяются на секторы, которые являются 
  основной единицей хранения информации на дисках. Использование секторов дает 
  возможность пользоваться общим методом хранения данных на дисках различных объемов. 
  Каждый раз , когда требуется передать данные от диска микропро- цессору, головка 
  считывания-записи устанавливается на определенную дорожку. После того как дорожка 
  вращается под головкой, контроллер диска осуществляет поиск нужного сектора, 
  сканируя проходящие под головкой секторы. Когда нужный сектор найден, контроллер 
  диска считывает из него данные и возвращает их. Число секторов на дорожке может 
  быть разным и зависит от объема сохраняемых на ней данных. Для дискет допускается 
  8, 9, 15 секторов на дорожку. </p>
<p>В жестких дисках количество секторов на дорожке, как правило, равно 17. Однако 
  в DOS допускается почти любое число секторов на дорожке. Нумерация и размер 
  секторов. Как правило, в PC-DOS и MS-DOS нумерация физических секторов начинается 
  с 1. Поэтому для диска с 9 секторами на дорожке секторы нумеруются от 1 до 9; 
  для жесткого диска с 17 секторами на дорожке секторы нумеруются от 1 до 17. 
  Этот метод нумерации используется в процедурах BIOS, осуществляющих форматирование, 
  чтение и запись секторов. Как уже говорилось, объем сохраняемых в каждом секторе 
  данных зависит от емкости дорожки и числа входящих в нее секторов (предполагается, 
  что плотность всех дорожек постоянна). Поскольку емкость дорожки фиксирована, 
  размер сектора можно изменять, меняя число секторов на дорожке. Обычно размер 
  сектора фиксирован и число секторов на дорожке вычисляется делением емкости 
  дорожки на размер сектора( плюс объем накладных расходов). В процессе форматирования 
  часть дискового пространства теряется при разбиении дорожки на секторы, а также 
  в результате записи на диск специальной информации, используемой для нахождения 
  секторов. Таким образом, объем доступного для использования дискового пространства 
  сокращается. Стандартный размер секторов в DOS. В DOS стандартный размер сектора 
  составляет 512 байт. Однако допускаются секторы размером 128, 256, 512 и 1024 
  байт. Секторы с объемом, отличным от 512 байт, ипользуются редко. Поскольку 
  многие части DOS ориентированы на работу с секторами размером 512 байт, при 
  использовании секторов с другими размерами могут возникнуть проблеммы, не разрешимые 
  без изменения самой DOS. На современных IBM и IBM-совместимых компьютерах обеспечивается 
  поддержка дисков любых объемов без необходимости привлечения специального программного 
  обеспечения. Данная задача решена с помощью драйверов. </p>
<p>10.1. Физический дисковый адрес </p>
<p><br>
  Дискета представляет собой круглую пластину, покрытую с двух сторон магнитным 
  материалом. Информация записывается раздельно на две стороны дискеты. В дисководе 
  к поверхности дискеты прижимаются две (по одной с каждой стороны) головки чтения/записи. 
  Пара головок может перемещаться вдоль радиуса дискеты, занимая на нем ряд фиксированных 
  положений. При вращении дискеты точки ее поверхности, которые могут находиться 
  в контакте с головками, образуют концентрические окружности, именуемые дорожками. 
  Дорожки делятся на секторы. Поскольку обмен информацией с дисками происходит 
  через пря мой доступ к памяти, сектор - это наименьший объем (блок) информации, 
  передаваемый за одну операцию чтения/записи. Объем сектора - 512 байт.<br>
  Жесткий диск представляет собой два или более дисков, посаженных на одну ось. 
  Все головки чтения/записи здесь, как и для дискеты образуют жесткий блок, то 
  есть перемещаются все вместе. Для жесткого диска вполне органичным является 
  понятие цилиндра - совокупности всех дорожек, расположенных на разных поверхностях 
  и равноудаленных от оси вращения. С точки зрения адресации понятия &quot;дорожка&quot; 
  и &quot;цилиндр&quot; являются синонимами.<br>
  Сектор является минимальной адресуемой единицей при обращениях к внешней памяти. 
  Адрес сектора на внешней памяти состоит из трех составляющих: </p>
<p>номер дорожки (нумерация дорожек начинается с 0); <br>
  номер головки (нумерация головок начинается с 0); <br>
  номер сектора на дорожке (нумерация секторов начинается с 1).</p>
<p>При записи на диск больших объемов информации мы заинтересованы в том, чтобы 
  свести к минимуму затраты по переключению на следующий сектор диска. Отсюда 
  вопрос: какой сектор считать следующим при последовательной записи (чтении) 
  ? Принят такой порядок его определения. Следующим считается сектор, расположенный 
  следующим на той же дорожке, под той же головкой (при записи сектора головки 
  за счет вращения диска установятся над следующим сектором, так что затраты времени 
  на переключения практически нулевые). При заполнении всей дорожки следующим 
  принято считать первый сектор дорожки, расположенный на том же цилиндре под 
  следующей головкой (этот сектор будет находиться под головками, а электрическое 
  переключение на другую головку - процесс быстрый). И только при заполнении всего 
  цилиндра меняется номер дорожки в адресе (этот процесс требует механического 
  перемещения головок и, следовательно, гораздо больших затрат времени).</p>
<p>t...t - младшие 8 бит номера дорожки; <br>
  TT - старшие 2 бита номера дорожки; <br>
  s...s - номер сектора на дорожке (6 бит).</p>
<p>В DOS для чтения/записи секторов служат прерывания (прерывания, а не функции 
  DOS!) 0x25 (чтение) и 0x26 (запись).<br>
  Обычный формат обращения к этим прерываниям следующий: AL - номер логического 
  диска (0 - A, 1 - B, 2 - C, etc.); <br>
  CX - количество секторов, которое нужно прочитать /записать; DX - логический 
  номер сектора; <br>
  DS:BX - адрес области оперативной памяти, с которой происходит обмен. <br>
  На выходе, как и для прерывания 0x13, устанавливается флаг переноса, а регистр 
  AH содержит код ошибки при наличии таковой.<br>
  Заметим, что дисковый адрес задается здесь не физический, а логический - номер 
  сектора относительно начала логического диска (о логических дисках - см. ниже). 
  Нумерация секторов внутри логического диска начинается с 0, и номер логического 
  сектора может быть вычислен как:</p>
<p>logs = ( (t * ns) + h) * nh + s-1; </p>
<p>где</p>
<p>t, h, s - физический адрес (дорожка, головка, сектор); <br>
  ns - количество секторов на дорожке, <br>
  nh - количество головок чтения/записи.<br>
  Для получения абсолютного номера сектора надо к вычисленному значению прибавить 
  еще некоторую величину s0 - абсолютный номер сектора начала логического диска.<br>
  Как мы увидим ниже, величины ns, nh, s0 могут быть получены из системной информации, 
  находящейся на самом носителе.</p>
<p><br>
</p>
<p>На физическом уровне можно управлять работой дисков с помощью прерывания 13h 
  BIOS. Изучить проблемы управления дисковой памятью можно по <a href="../library/v01b/ch1.htm" target=_blank>книге</a></p>
<h3 align="center">Логическая организация дисков. </h3>
<p>DOS поддерживает диски разных типов. Это стало возможным благодаря тому , что 
  информация, необходимая для работы с диском (например, его объем), сохраняется 
  на самом диске в специальной, определенной DOS, области. Для управления файлами 
  и дисковым пространством на каждом диске должна храниться дополнительная информация, 
  например объем использованного пространства и имена сохраняемых файлов. Эта 
  информация невидима для пользователя, но обязательно имеется на каждом диске. 
  Информация размещается на диске в определенной последовательности, поэтому все 
  диски DOS имеют сходную структуру. Это позволяет DOS получать информацию о типе 
  диска, о способе выделения дискового пространства, а также о размещенных на 
  нем файлах. Диск включает четыре области.</p>
<p align="center"><img src="images/disk_1.gif" width="500" height="600"> </p>
<p align="center">Рис.1. Логическая организация диска</p>
<p>Первая, зарезервированная область часто называется загрузочной записью. Вторая 
  область включает таблицу размещения файлов FAT(File Allocation Table), описывающую, 
  как используется дисковое пространство. Далее следует каталог файлов, в котором 
  хранится информация о длине, расположении, дате и времени создания каждого дискового 
  файла. Последней является область данных, в которой хранятся пользовательские 
  файлы. Область начальной загрузки, FAT и кластеры. Область начальной загрузки, 
  или резервируемая область, представляет первую секцию диска. Поскольку диски 
  могут иметь разное число рабочих сторон, дорожек и секторов, DOS должна определять 
  эти характеристики при первом обращении к диску. Описывающая диск информация 
  всегда должна храниться в строго установленном физическом участке диска. Обычно 
  это первый сектор диска- дорожка 0, поверхность 0, сектор 1.</p>
<p>Область начальной загрузки, как правило, занимает один сектор, но может быть 
  и больше. По этой причине ее чаще называют областью резервируемых секторов.На 
  рисунке показаны четыре составляющие области начальной загрузки: </p>
<li>код команды безусловного перехода jmp,</li> <br>
<li> идентификатор изготовителя, </li> <br>
<li> блок параметров BIOS </li> <br>
<li>программа начальной загрузки.</li> <br>
<p> В первых байтах области начальной загрузки хранится код команды jmp. Если 
  диск является системным диском DOS, в процессе операции начальной загрузки данные 
  считываются в память компьютера, после чего выполняется команда jmp, которая 
  обеспечивает переход к программе начальной, минуя идентификатор изготовителя 
  и блок параметров BIOS. Вторая часть области начальной загрузки представляет 
  8-байтовое поле, содержащее идентификатор изготовителя. DOS не использует это 
  поле. Обычно в это поле заносится название фирмы-изготовителя и версия DOS Третьей 
  частью области начальной загрузки является блок параметров BIOS. Это таблица 
  специальных параметров диска, используемых DOS при определении его емкости, 
  а также относительного расположения FAT и файлового каталога. Блок параметров 
  BIOS(ВРВ) имеется на каждом диске. Содержимое ВРВ описывается ниже. </p>
<p>Четвертая часть области начальной загрузки называется программой начальной 
  загрузки, поскольку в ней содержится программа, запускающая компьютер. Загрузочная 
  программа выполняет работу по запуску системы, связанную с загрузкой DOS в память. 
  Эта программа имеется в области начальной загрузки на всех дисках, независимо 
  от того , содержатся ли на диске системные файлы DOS, но используется только 
  в том случае, если диск системный. Системный диск можно создать с помощью программы 
  FORMAT, поставляемой с MS-DOS. В случае, если команда FORMAT используется со 
  специальным ключем(обычно/S), на диск копируются два дополнительных файла(чаще 
  всего IO.SYS и MSDOS.SYS), содержащие программы операционной системы MS-DOS. 
  Эти файлы скрыты от пользователя и не появляются в листинге дискового каталога. 
  Однако программа начальной загрузки "знает" об их присутствии и загружает их 
  в память во время загрузки системы. </p>
<p>Диск, с которого загружается операционная система, называется системным. При 
  форматировании с помощью программы DOS FORMAT все четыре секции области начальной 
  загрузки записываются в зарезервированную на диске область, которая всегда начинается 
  с первого сектора. </p>
<p>Кластеры - еденицы хранения файлов Прежде чем начать рассматривать таблицы 
  размещения файлов, вам необходимо понять, как данные сохраняются в секторах. 
  Когда программе тпебуется записать новые данные в дисковый файл, DOS ищет на 
  диске свободный сектор, с которо можно сохранить эти данные, и наоборот, при 
  чтении файла DOS ищет сектор, в котором хранятся нужные данные. Информация об 
  используемых данным файлом секторах сохраняется в таблице размещения файлов. 
  Эта таблица имеется на всех дисках DOS. Однако прослеживание файла сектор за 
  сектором может оказаться неэффективным. Например, жесткий диск на 10 Мегабайт 
  включает более чем 20000 секторов, и хранение информации о расположении каждого 
  из них потребует очень большой таблицы размещения файлов. Поиск внутри такой 
  таблицы будет относительно медленным. В меньшей по размеру таблице размещения 
  файлов поиск осуществляется быстреее, вследствие чего сокращяется время обращения 
  к файлу. Поэтому более эффективно объединение нескольких секторов в группу, 
  так что когда требуется выделить на диске дополнительное пространство, файлу 
  выделяется сразу группа секторов. Такие группы секторов называются кластерами. 
  Использование кластеров позволяет сэкономить выделяемое для таблицы размещения 
  файлов дисковое пространство. Кластеры обеспечивают более высокий уровень организации 
  диска и облегчают обращение </p>
<p>Изучить проблемы управления дисковой памятью на логическом уровне можно по 
  книгам <a href="../library/v01b/ch2.htm" target=_blank> [10],</a> и [<a href="../library/jourdain/510.htm"target=_blank>7</a>]</p>
<hr class=forhr align="center">
<div align="center">
  <table width="600">
    <tr> 
      <td> 
        <p align="center">&nbsp;</p>
      </td>
      <td> 
        <p align="center"><b> <a href="perif.htm">в начало раздела</a></b></p>
      </td>
      <td> 
        <p align="center">&nbsp;</p>
      </td>
    </tr>
  </table>
</div>
<h1>&nbsp;</h1  >
<p><strong></strong> <strong><font color="#0000FF"></font></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
