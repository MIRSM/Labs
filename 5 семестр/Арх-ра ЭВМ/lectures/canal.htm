<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="stylesheet" href="../images/styles.css" type="text/css">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<h1 align="center">Организация ввода-вывода.</h1>
<p>Любые вычислительные машины взаимодействуют с окружающей средой. Производительность 
  ЦП всегда гораздо больше, чем устройств ввода/вывода, так как они либо электромеханические, 
  либо связаны с взаимодействием с пользователем, и процесс ввода/вывода асинхронен 
  с ЦП. </p>
<p>По производительности устройства делятся на классы:  <br>
<li>низкоскоростные &lt;1000 символов в секунду (клавиатура, принтеры)  </li><br>
  <li>среднескоростные 1000-100000 символов в секунду (печатающие устройства, модемы, 
  гибкие магнитные диски, АЦП, ЦАП) </li> <br>
   <li>высокоскоростные &gt;100000 символов в секунду (скоростные АЦП, видеосистемы, 
  магнитные диски)). </li> 
<br>

<p>Существует несколько подходов к управлению вводом-выводом. Комплекс апараратно-прграммных 
  средсв, управляющих информационным обменом между ядром ЭВМ (ЦП и ОП) и ПУ называется 
  подсистемой ввода вывода или <b>каналом ввода-вывода. </b>Каналы которые бывают:</p>
<p>1. Программно управляемые, обмен в которых ведется непосредственно средствами 
  самого ЦП.<br>
  2. Прямого доступа в память (КПДП), обменом управляет специальный контроллер 
  или сопроцессор ввода/вывода , который инициализируется ЦП и передает данные 
  от заданного ПУ в заданную область ОП, или наоборот.</p>
<p>&nbsp;</p>
<p>Канал прямого доступа в память (DMA).</p>
<p>Контроллер работает по жесткой программе – его процедура не программируется. 
  Структура БИС контроллеров:<br>
  INTEL 8237 – стандартный кристалл. Восьми разрядная БИС, реализующая 4 канала, 
  каждый из которых обслуживает одно устройство DMA.<br>
  БШ – буфер шины. Четыре канала, один RG – счетчик адреса, второй – счетчик передаваемых 
  слов (CAR/BAR). <br>
  <br>
  <br>
  Такая структура обеспечивает авто инициализацию счетчика.<br>
  MR – регистр режима работы канала (MOD регистр).<br>
  БУ – блок управления. Четыре программно доступных регистра.<br>
  CR – режим управления.<br>
  SR – статус.<br>
  RG – регистр состояния каналов.<br>
  RR – регистр для управления отдельными каналами.<br>
  MASK – позволяет маскировать каналы.<br>
  TR – буферный регистр, используемый при передачи память – память.</p>
<p>Интерфейс: <br>
  DRQ – запрос на передачу данных, DACK – подтверждение этого запроса. К шине 
  микропроцессора подключают: D – двунаправленная информация. Адресная шина А0 
  /7 разбита на А0 /А3 (для обращения к внутренним регистрам) и А4/А7 (для управления 
  адресной шиной при обмене).<br>
  IOR, IOW – двунаправленные входные стробы при обращении к регистрам.<br>
  MRD, MWR – стробы чтения и записи при обращении к памяти, формируются контроллером.<br>
  AEN – формируется контроллером, поступает на системную шину, указывая на то, 
  кто в шине главный (главный тот, кто формирует адрес). Если контроллер не работает 
  AEN=0 – это означает, что хозяин шины ЦП. Все устройства, использующие DMA, 
  по этому сигналу отключаются от адресной шины.<br>
  CS – выбор кристалла – это сигнал адресной селекции регистров контроллера.<br>
  CLK – сигнал тактирования кристалла.<br>
  RST – общесистемный сброс.<br>
  EOP – сигнал формируется в последнем цикле обмена, говоря, что передается последний 
  байт. Если занулить принудительно, то обмен прервется.<br>
  ASTB – строб адреса – старшая часть адреса передается по ШД наружу.<br>
  RDY – формируется ПУ, чтобы расширить цикл обмена контроллера.<br>
  HLQ, HLDA – захват, подтверждение захвата. С использованием этих сигналов контроллер 
  взаимодействует с ЦП, захватывая шину.</p>
<p>Работа по обмену через DMA содержит три фазы: инициализация, обмен, завершение.<br>
  Инициализация. Инициатор – программа, выполняемая на ЦП. По этой программе загружаются 
  регистры контроллера и настраиваются каналы на выполнение операции. В каждый 
  канал поступает побайтно начальный адрес памяти и количество передаваемых байт 
  (CAR/BAR), затем загружается MR, который настраивает канал <br>
  (рис.17).<br>
  0,1 – режимы обмена по данному каналу. Всего четыре режима:<br>
  • Побайтовый – предполагает, что при обмене контроллер захватывает шину, передает 
  байт и освобождает шину. Следующий байт требует от ПУ следующего запроса. Шина 
  не монополизируется – это надежно.<br>
  • Блочный – контроллер захватывает шину и держит, пока не выполнится обмен. 
  216 циклов обмена может быть выполнено за один раз – не рекомендуется. В этом 
  режиме темп обмена задает контроллер – скоростной максимальный режим. Если ПУ 
  не будет успевать, то это его проблема.<br>
  • По требованию – синхронизирует работу контроллера и ПУ. Получив запрос от 
  ПУ (DRQ) контроллер захватывает шину, но обмен (выработка MEMR, MEMW) осуществляется 
  в темпе подачи DRQ.<br>
  • Расширение – режим каскадного включения нескольких контроллеров. Если количество 
  нужно больше, чем четыре (до шести), то на один канал сажают еще один контроллер. 
  CR – загружается при инициализации, содержит информацию, разрешающую работать 
  кристаллу и характеризующую режим взаимодействия кристалла с системной шиной 
  – удлинение цикла обмена, полярность сигналов DRQ, DASK. SR – статусный регистр 
  состоит из двух полубайт: старший указывает состояние канала (поступил DRQi 
  или нет), младший – поступил DACK или нет. <br>
  2,3 – типы цикла обмена. <br>
  4 – авто инициализация.<br>
  5 – направление приращения адреса.<br>
  6,7 – выбор канала (номер канала).</p>
<p>Фаза инициализации – загрузка. Запустив информацию, контроллер выполняет “пуск”: 
  <br>
  1. размаскировать DRQ<br>
  2. пуск устройства – все это делается через программный канал. </p>
<p>После этого ЦП в обмене не участвует, а контроллер ждет DRQ размаскированного 
  канала и начинает обмен: формирует запрос ЦП, который заканчивает цикл обмена 
  по системной шине, затем отключается от системной шины и сообщает об этом сигналом 
  HLDA. Тогда DMA выставляет сигнал AEN, после чего выдает на ШД старший байт 
  адреса ячейки, памяти сопровождая сигналом ASTB этот адрес фиксируется во внешнем 
  по отношению к контроллеру регистре, который транслирует его на ША. Младший 
  байт адреса ставится на младший разряд ША, дальше (MRD,IOW, MWR, IOR) сопровождаются 
  сигналом DACK. Затем, если побайтный обмен – освобождение канала (HRQ, AEN убирается, 
  когда убирается HLDA – работает ЦП). Когда счетчик байтов обнуляется, вырабатывается 
  EOP. <br>
</p>
<p>&nbsp;</p>
<p><br>
  <br>
</p>
</body>
</html>
