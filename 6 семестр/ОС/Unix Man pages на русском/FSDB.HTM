<html>
<head>
<title>FSDB(1M)</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>FSDB(1M)</h3>
<p align=justify><b>НАЗВАНИЕ</b><br>
        fsdb - отладчик файловых систем
<p><b>СИНТАКСИС</b>
<pre>
 /etc/fsdb  файловая_система [-]
</pre>
<p align=justify><b>ОПИСАНИЕ</b><br>
        Отладчик fsdb обычно используется для исправления  файловой  системы, испорченной в результате аварии. Отладчик может преобразовывать номера  блоков  и  описателей
        файлов в соответствующие дисковые адреса. Для доступа к
        отдельным  полям  описателей файлов существуют мнемонические обозначения. Все это сильно упрощает исправление
        управляющей информации или обход дерева файлов.
<p align=justify>        Файловая_система задается именем содержащего ее  специального файла.
<p align=justify>        Отладчик  использует несколько подпрограмм для контроля
        корректности адресов блоков и описателей файлов. В  качестве  основы  для  проверок из суперблока извлекаются
        размер в блоках списка описателей  файлов  и  размер  в
        блоках  всего  тома.  При  необходимости контроль можно
        отключить, если при вызове fsdb указать  опцию  -,  или
        воспользоваться командой O (см. ниже).
<p align=justify>        По умолчанию числа считаются десятичными.  Восьмеричные
        числа должны начинаться с нуля. Во время любой операции
        присваивания  проверяется, не отбрасываются ли значащие
        цифры из-за несоответствия типов левой и правой частей.
<p align=justify>        Отладчик fsdb читает данные порциями размером в блок и,
        следовательно, может работать как с бесструктурным, так
        и с блочным вводом/выводом. Для уменьшения  числа  системных вызовов чтения используются буфера, хранящие наиболее  часто  используемые  блоки данных. Все операции присваивания приводят к немедленной записи  измененного блока.
<p align=justify>        Отладчик fsdb распознает следуюшие символы:
<table>
<tr valign=top><th> #  <td>  Абсолютный адрес.
<tr valign=top><th> i  <td>  Преобразование номера описателя файла в адрес описателя.
<tr valign=top><th> b  <td>  Преобразование в адрес блока.
<tr valign=top><th>  d  <td>  Смещение элемента каталога.
<tr valign=top><th>   +, - <td> Адресная арифметика.
<tr valign=top><th>  q  <td>  Выход.
<tr valign=top><th>  >, &lt; <td> Сохранение/восстановление адреса
<tr valign=top><th>  =  <td>  Числовое присваивание.
<tr valign=top><th>   =+ <td>  Присваивание с увеличением.
<tr valign=top><th>  =-  <td> Присваивание с уменьшением.
<tr valign=top><th> =" <td>  Присваивание цепочки символов.
<tr valign=top><th>  O  <td>  Включение/выключение  контроля  корректности адресов.
<tr valign=top><th>  p  <td>  Общее средство печати.
<tr valign=top><th> f  <td>  Средство печати файлов.
<tr valign=top><th>  B  <td>  Байтный режим.
<tr valign=top><th>  W  <td>  Полусловный режим.
<tr valign=top><th>  D  <td>  Словный режим (слово считается 32-битным).
<tr valign=top><th>  !  <td>  Вызов shell'а.
</table>
<p align=justify>        При  печати  выводимую  информацию  можно форматировать
        различными способами. До начала  печати  текущий  адрес
        приводится  к границе, определяемой режимом. В процессе
        печати текущий адрес увеличивается и в итоге становится
        равным адресу последнего напечатанного элемента.  Вывод
        можно прервать, введя символ прерывания. Если за символом  p  идет  число,  то выводится указанное количество
        элементов. Производится проверка на  выход  за  границу
        блока, так как логически последовательные блоки в общем
        случае физически не последовательны. Если после символа
        p  задан 0, то выводятся все элементы до конца текущего
        блока. Доступны следующие опции печати:
<table>
<tr valign=top><th> i  <td>  Печатать как описатели файлов.
<tr valign=top><th> d  <td>  Печатать как каталоги.
<tr valign=top><th> o  <td>  Печатать как восьмеричные слова.
<tr valign=top><th> e  <td>  Печатать как десятичные слова.
<tr valign=top><th> c  <td>  Печатать как символы.
<tr valign=top><th> b  <td>  Печатать как восьмеричные байты.
</table>
<p align=justify>        Символ f используется для печати блоков данных, ассоциированных с текущим описателем файла. Если за  символом
        f  следует  число,  то печатается указанный блок файла.
        Блоки нумеруются, начиная с нуля. Буква необходимой опции печати идет за номером блока, если он есть, или непосредственно за символом f. Данное средство печати работает для файлов произвольного размера. При этом  проверяется,  не  является ли файл специальным, и не равны
        ли нулю указатели блоков, используемые для поиска  данных.
<p align=justify>        Точки, табуляции и пробелы можно использовать в качестве  разделителей функций, что, впрочем, не обязательно.
        Строка с единственным символом перевода строки увеличит
        текущий адрес на размер выведенного последним  элемента
        данных.  Тем  самым  адрес устанавливается на следующий
        байт, полуслово, слово, элемент каталога или  описатель
        файла, это позволяет перемещаться по однородным элементам  файловой  системы. Информация выводится в формате,
        соответствующем типу данных. Байты, полуслова  и  слова
        изображаются следующим образом: сначала идет восьмеричный  адрес, а за ним значение в восьмеричном и десятичном виде. Окончания .B или .D добавляются соответственно к адресам байтных или словных величин. Каталоги  выводятся так: сначала смещение элемента каталога, за ним
        десятичный номер описателя файла и символьное представление имени элемента. Описатели файлов выводятся с поименованными полями:
<table>
<tr valign=top><th> md <td>  Режим доступа.
<tr valign=top><th> ln  <td> Число ссылок.
<tr valign=top><th> uid <td> Числовой идентификатор владельца.
<tr valign=top><th> gid <td> Числовой идентификатор группы.
<tr valign=top><th> sz  <td> Размер файла в байтах.
<tr valign=top><th> a#  <td> Номера блоков данных (0-12).
<tr valign=top><th> at  <td> Время последнего доступа.
<tr valign=top><th> mt <td>  Время последней модификации.
<tr valign=top><th> ct <td>  Время последнего изменения описателя.
<tr valign=top><th> maj <td> Старший номер устройства.
<tr valign=top><th> min <td> Младший номер устройства.
</table>
<p><b>ПРИМЕРЫ </b><br>
<ol>
<li> Вывести описатель файла с  номером  3689.  Описатель
        3689 становится текущим:
<pre>
  3689i
</pre>
<li>  Присвоить  4  полю  числа ссылок текущего описателя
        файла:
<pre>
  ln=4
</pre>
<li> Увеличить на 1 поле числа ссылок:
<pre>
  ln=+1
</pre>
<li> Вывести в текстовом формате нулевой блок файла,  ассоциированного с текущим описателем:
<pre>
  fc
</pre>
<li> Вывести первые 32 элемента корневого каталога данной
        файловой системы:
<pre>
  2i.fd
</pre>
<li> Сделать  текущим  описатель,  ассоциированный с 5-м
        элементом каталога (нумерация с 0), найденным по предыдущей команде. Затем первый логический блок этого файла
        вывести в текстовом виде:
<pre>
  d5i.fc
</pre>
<li> Вывести суперблок данной файловой системы в  восьмеричном виде:
<pre>
  512B.p0o
</pre>
<li> Присвоить 3 номеру описателя файла для седьмого элемента  корневого каталога. Пример также показывает, как
        в одной строке задать несколько операций:
<pre>
  2i.a0b.d7=3
</pre>
<li> Поле имени в элементе каталога заменить  на  цепочку
        символов  name. При использовании nm двойные кавычки не
        обязательны, если первый символ является буквой:
<pre>
  d7.nm="name"
</pre>
<li> Вывести третий блок файла, ассоциированного с текущим описателем, в формате элементов каталога:
<pre>
  a2b.p0d
</pre>
</ol>
<p><b>СМ. ТАКЖЕ</b><br>
        <a href=FSCK.htm>fsck(1M)</a>.<br>
        <a href=DIR.htm>dir(4)</a>, <a href=FS.htm>fs(4)</a> <a href=INODE.htm>inode(4)</a> в Справочнике программиста.
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
