<html>
<head>
<title>FSDB(8)</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>FSDB(8)</h3>
<p align=justify><b>НАЗВАНИЕ</b><br>
fsdb - отладчик файловых систем.
<p><b>СИНТАКСИС</b>
<pre>
 /etc/fsdb special [-]
</pre>
<p align=justify><b>ОПИСАНИЕ</b><br>
fsdb может быть использована для залатывания поврежденной  файловой
системы после сбоя. Она содержит средства преобразования индексов и
номеров  блоков  в  соответствующие  адреса  на диске. Она содержит
также  мнемонические  смещения  для  получения  доступа к различным
частям  индексных  дескрипторов.  Это  существенно упрощает процесс
корректировки  структур  управляющего  блока  или  спуска по дереву
файловой системы.
<p align=justify>
fsdb  содержит  в  себе  несколько  процедур  контроля  ошибок  для
проверки  адресов  индексных  дескрипторов  и блоков. Эти процедуры
можно отключить, вызвав  fsdb с необязательным  аргументом - или  с
символом  O.  (fsdb  читает   структуры  размеров  дескрипторов   и
файлов из суперблока  файловой системы в  качестве базиса для  этой
проверки.)
<p align=justify>
Все числа  считаются по  умолчанию десятичными.  Восьмиричные числа
распознаются по нулевому  префиксу. Во время  операций присваивания
числа   проверяются   на   ошибки   усечения,   возникающие   из-за
несоответствия исходных и результирующих размеров.
<p align=justify>
fsdb читает поблочно  и поэтому может  работать как с  символьными,
так и с блочными  устройствами ввода/вывода. Для обращения  к часто
используемым  блокам  данных  используется  специальная   процедура
буферного управления, чтобы уменьшить количество системных  вызовов
операций   чтения.   Все   операции   присваивания   сопровождаются
немедленной записью в соответствующий блок.
<p>
Символы, распознаваемые fsdb:
<table>
<tr><td>#<td>абсолютный адрес</tr>
<tr><td>i<td>преобразование индекса в адрес дескриптора</tr>
<tr><td>b<td>преобразование к адресу блока</tr>
<tr><td>d<td>смещение поля каталога</tr>
<tr><td>+,-<td>адресная арифметика</tr>
<tr><td>q<td>выход</tr>
<tr><td>&gt;,&lt;<td>сохранение, восстановление адреса</tr>
<tr><td>=<td>численное присваивание</tr>
<tr><td>=+<td>присваивание со сложением</tr>
<tr><td>=-<td>присваивание с вычитанием</tr>
<tr><td>="<td>присваивание символьной строки</tr>
<tr><td>O<td>переключатель проверки ошибок</tr>
<tr><td>p<td>общие средства печати</tr>
<tr><td>f<td>средство печати файлов</tr>
<tr><td>B<td>байт</tr>
<tr><td>W<td>слово</tr>
<tr><td>D<td>двойное слово</tr>
<tr><td>!<td>выход в оболочку</tr>
</table>
<p align=justify>
Средства  печати  генерируют  форматированный  вывод  различных типов.
Перед началом печати текущий адрес нормализуется в подходящие пределы.
По мере печати он увеличивается и принимает значение адреса последнего
напечатанного элемента.  Выдача может  быть прекращена  в любой момент
введением  символа  удаления.  Если  за  символом  p следует число, то
печатается ровно  столько записей.  Выполняется проверка  на выход  за
границы блока, поскольку логический  порядок блоков в общем  случае не
совпадает  с  физическим.  Если  встречается  нулевой  указатель,   то
печатаются все записи до конца текущего блока. Допустимые опции печати
таковы:
<p><table>
<tr><td>i<td>печатать как индексный дескриптор</tr>
<tr><td>d<td>печатать как каталог</tr>
<tr><td>o<td>печатать в восьмиричном виде</tr>
<tr><td>e<td>печатать десятичными словами</tr>
<tr><td>c<td>печатать в символьном виде</tr>
<tr><td>b<td>печатать восьмиричными байтами</tr>
</table>
<p align=justify>
Символ f используется  для печати блоков  данных, связанных с  текущим
индексным дескриптором. Если за ним следует число, то печатается  блок
с  этим  номером.  (Блоки  нумеруются  от  нуля.)  Нужная опция печати
должна следовать за номером блока,  если он задан, или за  символом f.
Это средство печати работает как для малых, так и для больших  файлов.
Оно осуществляет проверку  специальных устройств и  указателей блоков,
которые используются для поиска данных и не должны быть нулевыми.
<p align=justify>
Точки,   табуляции   и   пробелы   могут   использоваться  в  качестве
разграничителей,  но  не  обязательны.  Строка, содержащая лишь символ
перевода  на  новую  строку,  увеличит  текущий  адрес  на размер типа
последнего напечатанного элемента. То  есть адрес будет установлен  на
следующий байт, слово, двойное слово, запись каталога или  дескриптор,
позволяя  пользователь  осуществлять  продвижение  по  части  файловой
системы. Информация печатается в  соответствии с типом данных.  Байты,
слова  и  двойные  слова  выводятся  вместе с восьмиричным адресом, за
которым следует восьмиричное или  десятичное значение. Для значений  в
байтовом представлении или в виде двойных слов к адресу добавляются .B
и  .D  соответственно.  Каталоги  печатаются  в  виде  смещения   поля
каталога,  за   которым  следуют   десятичный  индекс   и   символьное
представление имени. Индексные дескрипторы печатаются с метками полей,
описывающих каждый элемент.
<p align=justify>
Для  описания  текущего  рабочего  индексного дескриптора используется
следующая мнемоника:
<p><table>
<tr><td>md<td>режим</tr>
<tr><td>ln<td>указатель цепи (link count)</tr>
<tr><td>uid<td>пользовательский идентификатор</tr>
<tr><td>gid<td>групповой идентификатор</tr>
<tr><td>sz<td>размер файла</tr>
<tr><td>a#<td>номера блоков данных (0 - 12)</tr>
<tr><td>at<td>время доступа</tr>
<tr><td>mt<td>время модификации</tr>
<tr><td>maj<td>главное (большее) число устройство</tr>
<tr><td>min<td>малое ( меньшее) число устройства</tr>
</table>
<p align=justify><b>ПРИМЕРЫ</b>
<dl>
<dt>386i
<dd>выдача индекса 386 в формате индексного дескриптора. При
этом он становится текущим рабочим дескриптором.
<dt>ln=4
<dd>изменение  указателя   цепи  для   рабочего   индексного
дескриптора на 4.
<dt>ln=+1
<dd>увеличение этого указателя на 1.
<dt>fc
<dd>выдача  в  символьном  ASCII  виде нулевого блока файла,
связанного с рабочим дескриптором.
<dt>2i.fd
<dd>печать первых 32 записей  каталога корневого дескриптора
данной файловой системы.
<dt>d5i.fc
<dd>переустановка  с  текущего  дескриптора  на  дескриптор,
соответствующий  пятой  записи  каталога  (начиная с 0),
найденной по приведенной выше команде. Первый логический
блок файла после этого печатается в символьном виде.
<dt>512B.p0o
<dd>печатает суперблок файловой системы в восьмиричном виде.
<dt>2i.a0b.d7=3
<dd>переустанавливает  индекс  седьмого   поля  каталога   в
корневом каталоге на  3. В этом  примере демонстрируется
также, как можно скомбинировать в  одной командной
строке несколько операций.
<dt>d7.nm="name"
<dd>переустанавливает  поле  имени  в  каталоге  на заданную
строку. Если первый символ - буква, то при использовании
c nm кавычки необязательны.
<dt>a2b.p0d
<dd>печатает третий блок  текущего индексного дескриптора  в
виде записей каталога.
</dl>
<p><b>СМ. ТАКЖЕ</b><br>
<a href=FSCK~1.htm>fsck(8)</a>, dir(3), filesystem(3).
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
