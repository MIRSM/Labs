<html>
<head>
<title>CONFIGURE(8)</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>CONFIGURE(8)</h3>
<p align=justify><b>НАЗВАНИЕ</b><br>
configure - программа установки конфигурации в файле /kernel
<p><b>СИНТАКСИС</b>
<pre>
 configure [options] [parm=val ...]
</pre>
<p align=justify><b>ОПИСАНИЕ</b><br>
Программа configure  определяет и  изменяет различные  ресурсы ядра
системы. Для конечных пользователей использовать configure - легче,
чем  модифицировать  файлы  системной конфигурации непосредственно.
Для разработчиков драйверов устройств configure позволяет  избежать
трудностей  редактирования  файлов  конфигурации,  которые были уже
отредактированы предыдущей программой конфигурирования драйверов.
<p align=justify>
Ресурсы  модифицируются  в  интерактивном  режиме  или  с   помощью
аргументов  командной  строки.   Добавление  или  удаление   частей
устройств драйверов требует использования опций командных строк.
<p align=justify>
В следующих  параграфах объясняется,  как использовать  configure в
интерактивном режиме. Опции командной строки обсуждаются в  разделе
"Опции".

<p align=justify><i>Использование интерактивного режима</i><br>
configure функционирует  в интерактивном  режиме, если  в командной
строке не задано никаких опций или задана только опция -f.
<p align=justify>
Когда вы  вызываете configure  в интерактивном  режиме, вы  увидите
вначале меню следующего вида:
<pre>
  1.  Disk Buffers
  2.  Character Buffers
  3.  Files, Inodes, and Filesystems
  4.  Processes, Memory Management & Swapping
  5.  Clock
  6.  MultiScreens
  7.  Message Queues
  8.  Semaphores
  9.  Shared Data
  10. System Name
  11. Streams Data
  12. Event Queues and Devices
  13. Hardware Dependent Parameters
</pre><p align=justify>
Выберите категорию для изменения конфигурации, введя число от 1 до
13 или 'q' для выхода:
<p align=justify>
Для выбора категории введите ее номер (например, "1" для категории
"Disk Buffers") и нажмите RETURN.
<p align=justify>
Каждая категория содержит ряд конфигурируемых ресурсов. Каждый  ресурс
представляется  высвечиванием  его  действительного  имени,   краткого
описания и текущего значения.  Например, для категории "Disk  Buffers"
вы могли бы увидеть:
<pre>
  NBUF: total disk buffers. Currently determined at system start up:
  NSABUF: system-addressable (near) disk buffers. Currently 10:
  NHBUF: hash buffers (for disk block sorting). Currently 128:
</pre><p align=justify>
Для сохранения  текущего значения  нажмите просто  RETURN. В противном
случае  введите  подходящее  значение  для  соответсвующего  ресурса и
нажмите RETURN. configure проверяет каждое значение, попадает ли оно в
соответствующий диапазон или нет.  Если нет, то configure  предупредит
вас  об  этом  и  попросит  подтверждения,  не  хотите  ли вы изменить
рекомендуемое значение.
<p align=justify>
Для  выхода  из  configure  введите  'q'  на подсказку меню. Если были
внесены  какие-либо   изменения,  configure   спросит,  не   надо   ли
модифицировать файлы конфигурации в соответствии с этими  изменениями.
Для сохранения  старой конфигурации  нажмите на  эту подсказку  'n', и
изменения не будут учтены. В противном случае введите 'y', и configure
исправить нужные файлы системной конфигурации. После завершения работы
configure ядро системы готово к компоновке.
<p>
Для компоновки ядра введите:
<pre>
  link_kernel
</pre><p align=justify>
Компоновка может занять  несколько минут. После  завершения компоновки
ядра введите следующие команды для перенесения нового ядра (xenix.new)
в корневой каталог и перегрузите систему:
<pre>
 cp /usr/sys/conf/kernel  /kermel.new
 /etc/shatdown
</pre>
Затем вы увидите загрузочную подсказку:
<pre>
 Boot
 :
</pre>
Для выполнения тестирования нового ядра введите на эту подсказку
<pre>
 kernel.new
</pre><p align=justify>
Теперь  система  будет  работать  с  новым  ядром.  Когда  вы   будете
удовлетворены  функционированием  нового  ядра,  введите для установки
этого ядра на жесткий диск следующую команду:
<pre>
 /usr/sys/conf/hdinstall
</pre>
Программа <a href=HDINSTAL.htm>hdinstall(8)</a> выполняет резервное копирование старого файла
/kernel и записывает на его место /usr/sys/conf/kernel.
<p>
Удалите kernel.new введением следующей команды:
<pre>
 rm /kernel.new
</pre>
Перезагрузите систему с новым ядром.
<p align=justify><i>Опции</i><br>
Опции   командной    строки   предназначены    для    разработчиков
программ-оболочек  инсталляции  драйверов.  Из  командной строки вы
можете конфигурировать драйверы,  удалять определения драйверов  из
конфигурационных  файлов   и  модифицировать   некоторые   атрибуты
драйверов.  Имеются  также  опции  для запроса текущей конфигурации
драйверов.
<p>
configure использует следующие опции:
<pre>
  -a [func1 func2 ...]
  -d [func1 func2 ...]
  -b
  -c
  -d [func1 func2 ...]
  -f master_file [dfile]
  -g dev_name handler | dev_name
  -j [prefix] [NEXTMAJOR]
  -l priority_level
  -m major
  -n
  -q
  -r
  -t
  -v interrupt_vector [interrupt_vector2 ...]
  -w
  -x
  -y  resource
</pre>
<table>
<tr valign=top><td><b>-m, -b и -c</b><td>
Эти  опции  используется  для  конкретизации  ссылки на драйвер.
Вслед  за  опцией  -m  должен  идти  главное  число   устройства
драйвера.  Если  вы  конфигурируете  блочный  драйвер,  то нужно
указывать это  опцией -b;  если же  вы конфигурируете символьный
драйвер, то ему соответствует  опция -с. Обе опции  используются
при конфигурировании драйвера с обоими типами интерфейса.</tr>
<tr valign=top><td><b>-a и -d</b><td>
Каждая  из  этих  опций  сопровождается  списком добавляемых или
удаляемых функций соответственно. Имена этих функций  содержатся
в  bdevsw[]  или  сdevsw[],  ими  являются  также имена процедур
инициализации, опроса, остановки и прерываний, если они имеются,
плюс имена  терминала, потока  и указателей  табличных структур.
configure  вводит  в  действие  правила,  по которым все функции
драйвера должны  иметь общий  префикс, который  должен быть  2-4
символа длиной.</tr>
<tr valign=top><td><b>-j</b><td>Если за этой опцией следует префикс, используемый драйвером,  то
высвечивается  главное  число  этого  драйвера.  Если  же за ней
следует NEXTMAJOR,  то выводится  самое маленькое  главное число
драйверов.</tr>
<tr valign=top><td><b>-r</b><td>Эта опция  задает принудительную перезапись  файлов конфигурации
независимо  от  того,  внесены  ли  в  конфигурацию   какие-либо
изменения или нет.</tr>
<tr valign=top><td><b>-v</b><td>Эта   опция  модифицирует  задание  векторов  прерывания данного
устройства. Устройство  может использовать  до четырех  векторов
прерывания.</tr>
<tr valign=top><td><b>-l</b><td>Эта   опция  устанавливает  приоритет  прерывания  для   данного
устройства, который  почти всегда  совпадает с  используемым при
вызове spl(): драйвер осуществляющий блокировку с использованием
sp5() почти всегда имеет приоритет прерывания 5.</tr>
<tr valign=top><td><b>-q</b><td>Если  задается опция  -q, то  после   возвращения из  прерывания
использование qswtch()  невозможно. Использование  этой опции  в
новых драйверах не рекомендуется.</tr>
<tr valign=top><td><b>-f</b><td>Конфигурация поддерживается с помощью двух файлов данных  master
и  unixconf.  Опцию  -f  можно  использовать для задания других
имен.  Обратите  внимание,  что  это  единственная  опция,   при
введении  которой  в  командную   строку  программа  все   равно
запускается в интерактивном режиме.</tr>
<tr valign=top><td><b>-n</b><td>Если присутствует эта опция, то два упомянутых  конфигурационных
файла модифицируются,но  никаких файлов  '.o' не  создается. Эта
опция полезна при конфигурировании пакета драйверов, содержащего
несколько драйверов.</tr>
<tr valign=top><td><b>-w</b><td>Эта опция подавляет сообщения-предупреждения.</tr>
<tr valign=top><td><b>-x</b><td>Эта     опция   задает   выдачу   полной   информации   по  всем
характеристикам  ресурса,  известным  для  configure.  При  этом
выявляется   имя,   описание   и   текущее   значение    каждого
конфигурируемого параметра. Подсказки категорий не дампируются.</tr>
<tr valign=top><td><b>-y</b><td>Эта опция задает печать текущего значения требуемого ресурса.</tr>
<tr valign=top><td><b>-t</b><td>Эта опция  не печатает ничего  (кроме, быть может,  сообщений об
ошибках).  Однако,  она  возвращает  1, если уже сконфигурирован
драйвер, соответствующий комбинации опций -m, -b, -c, и 0 - если
такого драйвера нет.</tr>
<tr valign=top><td><b>-g</b><td>Эта    опция    используется   для   добавления   или   удаления
программ-обработчиков  для  устройств  графического ввода (GIN).
Эти программы могут направить ввод данных с таких устойств,  как
"мыши",  графические  планшеты  и  клавиатуры, внутрь "событий".
Флагу   -g   может   быть   придан   один   аргумент,    который
интерпретируется   как   имя   устройства.   Это  GIN-устройство
удаляется из  конфигурационных файлов.  Если флагу  -g придается
два аргумента, то второй из них задает программу-обработчика,  и
устройство добавляется  в конфигурационные  файлы. Если  оно уже
имеется,  то  его  обработчик  модифицируется,  а   пользователю
посылается сообщение. Задавая -g несколько раз, можно  добавлять
или удалять несколько устройств.
</tr></table>
<p align=justify><i>Установка параметров командной строки</i><br>
В командную строку может  быть введено любое количество  аргументов
вида resource=value. Эти аргументы могут быть заданы одновременно с
запросом драйвера на добавление или удаление, но должны идти  вслед
за всеми аргументами конфигурации драйвера в командной строке.
<p align=justify>
Некоторые  ресурсы  имеют  в  качестве  своих  значений  символьные
строки.  В  этом  случае  эти  значения  должны  заключаться внутри
символов   \".   Кавычки   синтаксически   необходимы,   чтобы  они
использовались  как  строки  языка  Си,  а  обратные косые черточки
предохраняют эти кавычки от их удаления программой-оболочкой.
<p align=justify><b>ПРИМЕРЫ</b><br>
Напечатайте текущее значение NCLIST:
<pre>
  configure -y NCLIST
</pre>
Обеспечьте возврат 1, если доступны главное число символьного
устройства 7 и вектор 3:
<pre>
  configure -t -v 7 -m 3 -c
</pre>
Добавьте выполнение опроса по часам и процедуру инициализации к уже
сконфигурированному  драйверу  "foo",  гипотетическому  символьному
драйверу с главным числом устройства #17:
<pre>
  configure -a foopoll fooinit -c -m 17
</pre>
Удалите драйвер "foo":
<pre>
  configure -m 17 -d -c
</pre><p align=justify>
Добавьте новы й драйвер "hypo", драйвер блочного типа с  символьным
интерфейсом.  Он  использует  три  различных  вектора  прерывания с
приоритетом 6:
<pre>
  configure -a hypoopen hypoclose hyporead hypowrite hypoioctl\
  hypostrategy hypotab hypointr -b -c -l 6 -v 17 42 49
</pre>
<p align=justify><b>ПРИМЕЧАНИЯ</b><br>
<i>Ограничения на область данных ядра системы</i><br>
Если общий объем всех зарезервированных ресурсов становится слишком
большим,  то  группа  не  уместится  в пределах 64K сегмента данных
ближней зоны  ядра системы.  Вы не  дождетесь никаких  сообщений  о
превышении  размера  от  configure,  но  вы  можете  получить их от
компоновщика при попытке скомпоновать ядро.
<p><b>ФАЙЛЫ</b>
<pre>
/usr/sys/conf/master
/usr/sys/conf/unixconf
/usr/sys/conf/config
</pre>
<p><b>СМ. ТАКЖЕ</b><br>
master(3), <a href=CONFIG~1.htm>config(8)</a>, event(5), <a href=HDINSTAL.htm>hdinstall(8)</a>
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
