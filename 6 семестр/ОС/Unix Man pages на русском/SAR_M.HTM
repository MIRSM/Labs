<html>
<head>
<title>SAR(1M) </title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>SAR(1M) </h3>
<p align=justify><b>НАЗВАНИЕ</b><br>
sar: sa1, sa2, sadc - получение информации о функционировании системы
<p><b>СИНТАКСИС</b>
<pre>
	/usr/lib/sa/sadc  [сек число] [вых_файл]
	/usr/lib/sa/sa1  [сек число]
	/usr/lib/sa/sa2  [-u] [-b] [-d] [-y] [-c] [-w] [-a] [-q] [-v] [-m] [-A]
		         [-s время] [-e время] [-i сек]
</pre>
<p align=justify><b>ОПИСАНИЕ</b><br>
Информацию о функционировании системы можно получать по
специальному  запросу пользователя [см. <a href=SAR.htm>sar(1)</a>] или автоматически, с помощью описанных ниже программ.  Операционная система имеет набор счетчиков, которые увеличиваются  при  выполнении  некоторых  системных действий.
Учитывается использование ЦП и буферов,  ввод/вывод  на
ленту  и диск, на терминалы, переключение между процессами, выполнение системных вызовов,  доступ  к  файлам,
работа  с  очередями,  взаимодействие между процессами,
работа с виртуальными страницами и удаленными  ресурсами.
<p align=justify>Утилита sadc и shell-процедуры sa1 и  sa2  используются
для сбора, сохранения и обработки этих данных.
<p align=justify>Утилита sadc, сборщик данных, собирает системную информацию заданное число раз через указанное количество секунд  и записывает ее в двоичном виде в вых_файл или на
стандартный вывод. Если аргументы сек и число  опущены,
выводится запись специального вида. Эта возможность используется при загрузке системы, чтобы отметить момент,
когда  все счетчики сбрасываются в 0. Следующая команда
из файла /etc/init.d/perf
<pre>
	su sys -c "/usr/lib/sa/sadc /usr/adm/sa/sa`date +%d`"
</pre>
<p align=justify>записывает в ежедневный  протокол  специальную  запись,
отмечающую перезапуск системы.
<p align=justify>Shell-процедура sa1,  вариант  sadc,  используется  для
сбора  и  сохранения  данных  в  двоичном  виде в файле
/usr/adm/sa/saдд, где дд - это текущий день. Смысл  аргументов  сек  и  число  тот же, что и в случае утилиты
sadc, их подразумеваемые значения  равны  1.  Следующие
строки   из   файла  /usr/spool/cron/crontabs/sys  [см.
<a href=CRON.htm>cron(1M)</a>]
<pre>
	0 * * * 0,6 /usr/lib/sa/sa1
	20,40 8-17 * * 1-5 /usr/lib/sa/sa1
</pre>
<p align=justify>приводят к тому, что в рабочее время информация собирается  каждые 20 минут, а в остальное время - один раз в
час.
<p align=justify>Shell-процедура  sa2,  вариант <a href=SAR.htm>sar(1)</a>, записывает ежедневный отчет в файл /usr/adm/sa/sarдд. Смысл опций  тот
же,  что  и  в случае <a href=SAR.htm>sar(1)</a>. Следующая строка из файла
/usr/spool/cron/crontabs/sys
<pre>
	5 18 * * 1-5 /usr/lib/sa/sa2 -s 8:00 -e 18:01 -A
</pre>
<p align=justify>позволяет выдать все сведения о  системной  активности,
накопленные в рабочее время.
<p align=justify>Структура двоичного файла с ежедневной информацией  такова:
<pre>
struct sa {
  struct sysinfo si; /* См. <sys/sysinfo.h> */
  struct minfo mi;   /* См. <sys/sysinfo.h> */
  struct dinfo di;   /* См. <sys/sysinfo.h> */
  int minserve, maxserve /* Мин. и макс. загруженность
                            исполнителя РУФ */
  int szinode;  /* Число элем. в табл. описателей файлов */
  int szfile;   /* Число элем. в табл. файлов */
  int szproc;   /* Число элем. в табл. процессов */
  int szlckf;   /* Число элем. в табл. "закрытых" файлов */
  int szlckr;   /* Число элем. в табл. "закрытых" записей */
  int mszinode; /* Размер табл. описателей */
  int mszfile;  /* Размер табл. файлов */
  int mszproc;  /* Размер табл. процессов */
  int mszlckf;  /* Макс. размер табл. "закрытых" файлов */
  int mszlckr;  /* Макс. размер табл. "закрытых" записей */
  long inodeovf;/* Число переполнений табл. описателей */
  long fileovf; /* Число переполнений табл. файлов */
  long procovf; /* Число переполнений табл. процессов */
  time_t ts;    /* Текущее время */
  long  devio[NDEVS][4];  /* Информация об устройствах */
#define IO_OPS  0   /* Общее число запросов на ввод/вывод */
#define IO_BCNT 1   /* Общее число переданных блоков */
#define IO_ACT  2   /* Общее время ожидания освобождения
                       устройства (в тактах часов) */
#define IO_RESP 3   /* Общее время работы устройства по
                       вводу/выводу (в тактах часов) */
};
</pre>
<p><b>ФАЙЛЫ</b>
<pre>
	/usr/adm/sa/saдд     Файлы с ежедневной информацией.
	/usr/adm/sa/sarдд    Файлы с ежедневными отчетами.
	/tmp/sa.adrfl        Файл с адресами.
</pre>
<p><b>СМ. ТАКЖЕ</b><br>
<a href=CRON.htm>cron(1M)</a>.<br>
<a href=SAG.htm>sag(1G)</a>, <a href=SAR.htm>sar(1)</a>, <a href=TIMEX.htm>timex(1)</a> в Справочнике пользователя.
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
