<html>
<head>
<title>SCHEDULE(8)</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>SCHEDULE(8)</h3>
<p align=justify><b>НАЗВАНИЕ</b><br>
schedule - база данных для автоматического системного резервного
копирования.
<p align=justify><b>ОПИСАНИЕ</b><br>
База  данных  schedule   используется  совместно  с  <a href=FSPHOTO.htm>fsphoto(8)</a> для
полу-автоматического системного резервного копирования. Для  каждой
файловой  системы,  подлежащей  резервному  копированию,   задается
циклический график уровней резервного копирования <a href=BACKUP.htm>backup(1)</a>.
<p align=justify>
Этот  циклический  график  (или  цикл)  представляет  собой  список
уровней дампа (включая отсутствие такового) и указатель  последнего
выполненного  элемента  этого  списка.  Этот  указатель   регулярно
передвигается  на  очередной  элемент  списка  (при  каждом запуске
fsphoto, обычно раз в день), начиная сначала при завершении списка.
Впрочем, это передвижение осуществляется только в случая  успешного
выполнения нужного дампа.
<p align=justify>
Каждая структура  в этом  файле занимает  отдельную строку.  Пустые
строки и строки комментариев (начинающиеся с #) могут располагаться
в любом месте. Распознаются некоторые ключевые слова:
<dl>
<dt>site sitename
<dd>Аргумент sitename передается  команде fsave в  качестве описания
метки ленты.  Обычно sitename  - это  название фирмы  или номера
здания.
<dt>media drive k sizes... [format]
<dd>Устройство  drive  -  это  дисковод  гибких  дисков,   способный
обслуживать диски перечисленных  емкостей sizes (в  килобайтах).
Аргумент format,  если он  задан, -  это команда  системы  UNIX,
используемая для форматирования описанных дискет.
<dt>media drive d density sizes... [format]
<dd>Устройство drive - это стример, поддерживающий плотность  записи
density и способный  обслуживать ленты указанных  размеров sizes
(в футах). Как и для дискет, format - это команда системы  UNIX,
используемая для форматирования описанных лент.
<dt>[0-9] size savetime importance marker
<dd>Описание  каждого   уровня  резервного   копирования,  как   это
представлено  в  разделе  <a href=FSAVE.htm>fsave(8)</a>.  Установки  по   умолчанию
таковы:
<table>
<tr><valign=top><th>Level (уровень)<th>Size (размер)<th>Savetime (время хранения)<th>Importance (важность)<th>Marker (маркер)</tr>
<tr><td>0<td>-<td>"1 год"<td>критическая<td>нет</tr>
<tr><td>1<td>-<td>"3 месяца"<td>необходимая<td>нет</tr>
<tr><td>2...7<td>-<td>"1 месяц"<td>важная<td>нет</tr>
<tr><td>8<td>-<td>"2 недели"<td>полезная<td>нет</tr>
<tr><td>9<td>-<td>"1 неделя"<td>предупредительная<td>нет</tr>
</table>
<p>Должны  быть  заданы  все  четыре  поля.  Поле size подразумевает
использование первого размера, заданного в соответствующем списке
media sizes.
</dl>
<p align=justify>
Ключевые слова должны  помещаться впереди всех  графиков резервного
копирования файловых систем. Эти графики задаются в виде:
<dl>
<dt>/dev/rfilesys cycle
<dd>Файловая  система,  располагающаяся  на устройстве /dev/filesys,
предназначается  для  резервного  копирования  в соответствии со
значением цикла cycle, который представляет собой список уровней
дампа разделенных пробелами (команде dump передаются цифры от  0
до 9) или букв x, означающих отсутсвие дампа.
</dl>
<p align=justify>
Список дампа cycle  должен иметь по  крайней мере один  элемент, но
длина его не ограничивается. Различные файловые системы могут иметь
списки cycle различной длины.
<p>
Вот пример файла schedule:
<pre>
# SYSTEM BACKUP SCHEDULE
site mymachine

# Media entries

# 96 tpi 1.2 MB floppy 0
# media /dev/rfd096ds15 k 1200 format /dev/rfd096ds15

# 96 tpi 1.2 MB floppy 1
# media /dev/rfd196ds15 k 1200 format /dev/rfd196ds15

# Cartridge tape 0
# media /dev/rct0 d 20000 300 450 600 tape erase

# 9-track tape 0
# media /dev/rmt0 d 1600 2400 1200 600

# Backup Descriptor Table
#  Backup   Vol.   Save for    Vitality      Label
#  level    size   how long   (importance)   marker
   0        -      "1 year"   critical       "a red sticker"
   1        -      "4 months" necessary      "a yellow sticker"
   8        -      "3 weeks"  useful         "a blue sticker"
   9        -      "1 week"   precautionary  none
# Schedule Table
#            1 2 3 4 5   6 7 8 9 0   1 2 3 4 5   6 7 8 9 0
# Filesystem M T W T F   M T W T F   M T W T F   M T W T F
  /dev/rroot 0 x 9 x 9   8 x 9 x 9   1 x 9 x 9   8 x 9 x 9
  /dev/ru    9 0 9 9 9   9 8 9 9 9   9 1 9 9 9   9 8 9 9 9
</pre><p align=justify>
В   приведенном   выше    примере   файловая   система    /dev/root
копируется на  уровне 0,  когда fsphoto  запускается первый  раз (в
понедельник), и если этот дамп пройдет успешно, то в следующий  раз
(во вторник) резервное копирование не выполняется. Если и этот этап
пройдет успешно,  то в  третий раз  (среда) будет  выполняться дамп
9-го  уровня.  В  случае  его  успешного завершения в четвертый раз
(четверг)  дамп  не  выполняется,  а  в  пятый  раз запуска fsphoto
(пятница) будет выполняться дамп 9-го уровня.
<p align=justify>
После  каждого  успешного  выполнения  дампа  на  заданном   уровне
указатель продвигается таким образом, что очередной запуск  fsphoto
(на  следующий  день  недели)  выполняет запланированный для данной
файловой  системы  следующий  дамп.   Если  же  дамп  не   проходит
(прерванный   или   отложенный   оператором),   то   указатель   не
продвигается. Таким  образом, в  очередной раз  при запуске fsphoto
будет пвторен дамп  того же уровня,  так что последовательность  не
будет нарушена (но время может сместиться).
<p align=justify>
Продолжая этот  пример, на  19-й запуск  fsphoto будет  выполняться
дамп /dev/rroot 9-го уровня, на двадцатый раз дамп не  выполняется,
а на  двадцать-первый раз  (понедельник каждой  пятой недели)  цикл
начнется сначала с дампа 0-го уровня.
<p align=justify>
Для более  крупной и  быстрее меняющейся  файловой системы  /dev/ru
дампирование выполняется чаще (при  каждом запуске fsphoto -  раз в
день,  а  не  через  раз),  и  уровни  выбраны так, чтобы исключить
выполнение двух полномасштабных дампов (например, на уровнях 0 и 1)
крупных  файловых  систем  в  один  и  тот же день. Цикл резервного
копирования короче - две недели вместо четырех.
<p><b>СМ. ТАКЖЕ</b><br>
<a href=FSPHOTO.htm>fsphoto(8)</a>, <a href=FSAVE.htm>fsave(8)</a>, <a href=BACKUP.htm>backup(1)</a>
<p align=justify><b>ПРИМЕЧАНИЯ</b><br>
Ключевые слова и имена файлов не должны следовать за пробелами или
табуляциями.
<p align=justify>
Нет необходимости задавать имя первичного (/dev/r*) устройства  для
каждой файловой системы, но если это сделано, резервное копирование
пойдет быстрее.
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
