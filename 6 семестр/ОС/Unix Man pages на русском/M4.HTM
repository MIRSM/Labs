<html>
<head>
<title>M4(1)</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>M4(1)</h3>
<p align=justify><b>НАЗВАНИЕ</b><br>
m4 - макропроцессор
<p><b>СИНТАКСИС</b>
<pre>
   m4  [-e] [-s] [-Bцелое] [-Hцелое] [-Sцелое] [-Tцелое] [-Dимя[=значение]
  [-Uимя] [файл ...]
</pre>
<p align=justify><b>ОПИСАНИЕ</b><br>
Макропроцессор  m4  предназначен  для макрогенерации на
предварительном проходе в языках RATFOR,  C  и  других.
Все  файлы-аргументы  обрабатываются  по  очереди. Если
файлы не указаны, или в качестве имени файла  задан  -,
то  читается стандартный ввод. Обработанный текст записывается на стандартный вывод.
<p align=justify>Допустимы следующие опции:
<dl>
<dt>-e  <dd> Работать интерактивно. Прерывания  игнорируются  и
вывод не буферизуется.
<p><dt>-s  <dd> Разрешить вывод операторов #line для  C-препроцессора.
<p><dt>-Bцелое <dd>   Сменить размеры буфера повторного  сканирования  и
буфера,  в  котором  накапливаются  аргументы.  По
умолчанию размер равен 4096.
<p><dt>-Hцелое <dd>     Сменить размер хэш-таблицы имен с 199  по  умолчанию. Размер должен быть простым числом.
<p><dt>-Sцелое <dd>     Сменить размер стека вызовов со 100  элементов  по
умолчанию. Макрос занимает 3 ячейки в стеке  вызовов; аргумент занимает одну ячейку.
<p><dt>-Tцелое <dd>     Изменить размер буфера лексем с 512 байт по  умолчанию.
</dl>
<p align=justify>Чтобы эти опции действовали, они  должны  располагаться
перед всеми именами файлов и перед опциями -D и -U:
<dl>
<dt>-Dимя[=значение] <dd>     Эта опция определяет имя равным значению или  пустой цепочке, если значение отсутствует.
<p><dt>-Uимя <dd>     Делает имя неопределенным.
<p><dt>Макровызовы имеют следующий вид:
<pre>
	имя(арг1,арг2, ...аргn)
</pre>
<p align=justify>Левая скобка должна следовать непосредственно за именем
макроса. Если за именем определенного макроса не следует (, то полагается, что макрос вызван без  аргументов.
Имя  макроса  может  состоять  из букв, цифр и символов
подчеркивания, причем первым  символом  не  может  быть
цифра.
</dl>
<p align=justify>В процессе сбора аргументов m4 игнорирует не  заключенные в кавычки начальные пробелы,  табуляции  и  символы
перевода строки. Для того, чтобы запретить  интерпретацию цепочки символов, их заключают между правой и левой
одинарными кавычками:
<pre>
	`эта цепочка не интерпретируется'
</pre>
<p align=justify>Значение цепочки символов, заключенной в кавычки, равно
самой этой цепочке без внешних кавычек.
<p align=justify>Когда имя макроса распознано, его аргументы  собираются
путем поиска парной правой скобки. Если аргументов оказалось меньше, чем используется в определении  макроса,
то последним аргументам будут даны пустые  значения.  В
процессе сбора аргументов продолжается макрообработка и
все не взятые в кавычки запятые и правые скобки,  которые образовались в результате  вложенных  макровызовов,
действуют так же, как будто они встретились в  исходном
тексте. После сбора аргументов значение макроса  сканируется повторно, так как если бы оно  было  в  исходном
тексте.
<p align=justify>M4 предоставляет следующие встроенные макросы,  которые
могут быть переопределены, но в этом случае их первоначальный смысл теряется. Значения  встроенных  макросов,
если не оговорено противное, равны пустой цепочке.
<dl>
<dt>define <dd>     Второй аргумент  становится  значением  макроса  с
именем, равным первому аргументу. Если в  значение
макроса входят пары символов $n, где n - цифра, то
при вызове этого макроса они  заменяются  на  n-ый
аргумент. Нулевым аргументом является имя макроса;
пропущенные аргументы заменяются на пустые  цепочки; $# заменяется количеством аргументов; $* заменяется на список всех аргументов, разделенных  запятыми; $@ заменяется тоже на  список  аргументов,
но каждый аргумент заключен в кавычки,  являющиеся
текущими.
<p><dt>undefine <dd>     Удаляет определения макросов, имена которых заданы
в качестве аргументов.
<p><dt>defn <dd> Возвращает заключенные в кавычки определения своих
аргументов. Это полезно для переименования  макросов, особенно встроенных.
<p><dt>pushdef <dd>     Действует аналогично define, но сохраняет все предыдущие определения.
<p><dt>popdef <dd>     Удаляет текущие  определения  своих  аргументов  и
восстанавливает предыдущие, если они есть.
<p><dt>ifdef <dd> Если первый аргумент определен, то значение будет
 равно  второму  аргументу,  в  противном   случае
 третьему.  Если третьего аргумента нет, то значе ние будет пустым. Слово unix заранее определено в
 версиях m4 для системы UNIX.
<p><dt>shift <dd> Возвращает все свои аргументы кроме первого, зак лючив их в кавычки и отделив друг от друга  запя тыми.
<p><dt>changequote <dd>     Первый и второй аргументы становятся новыми символами-кавычками вместо ` и '. Эти  аргументы  могут
содержать  до 5 символов. Changequote без аргументов возвращает первоначальные  значения  (то  есть
`').
<p><dt>changecom <dd>     Изменяет левый и правый маркеры комментария, которые первоначально равны # и символу перевода строки. Если нет аргументов, то механизм  комментариев
полностью подавляется. Если задан  один  аргумент,
то он становится левым  маркером  комментариев,  а
правым маркером становится  перевод  строки.  Если
заданы два аргумента, то они  становятся  левым  и
правым маркерами. Маркеры комментариев  могут  содержать до 5 символов.
<p><dt>divert <dd>     M4 поддерживает 10 выходных потоков, под  номерами
0-9. Окончательный результат получается конкатенацией всех этих потоков в порядке возрастания номеров; первоначально текущим потоком является  нулевой. Макрос divert меняет выходной поток на  поток
с номером, заданным аргументом (в виде цепочки десятичных цифр). Вывод, направленный во все  потоки
кроме 0-9, теряется.
<p><dt>undivert <dd>     Вызывает немедленный вывод текста из потоков,  номера которых указаны как аргументы,  или  из  всех
потоков, если аргументы не указаны. Выведенные потоки очищаются. Текст может быть выведен  в  любой
поток.
<p><dt>divnum <dd>     Возвращает номер текущего выходного потока.
<p><dt>dnl  Читает и удаляет символы до следующего символа перевода строки включительно.
<p><dt>ifelse <dd>     Имеет 3 или более аргументов. Если первый аргумент
совпадает как цепочка символов со вторым,  то  результатом будет третий аргумент. Если нет, то, если аргументов более чем 4, то процесс  повторяется
с аргументами под номером 4, 5, 6 и 7 (4-ый и 5-ый
аргументы сравниваются и т.д.) Если же  аргументов
не более 4, то результатом будет 4-ый аргумент или
пустая цепочка при его отсутствии.
<p><dt>incr <dd> Возвращает значение своего аргумента,  увеличенное
на 1. Аргумент, который должен быть цепочкой цифр,
интерпретируется как десятичное число.
<p><dt>decr <dd> Возвращает значение своего аргумента,  уменьшенное
на 1.
<p><dt>eval <dd> Вычисляет свой аргумент как арифметическое выражение,  используя  32-битную  арифметику. Допустимые
операции включают +, -, *, /, %; побитные операции
&, |, ^, и ~; операции отношения; скобки.  Восьмеричные и шестнадцатеричные числа могут быть заданы
как  в  языке C. Второй аргумент указывает систему
счисления для результата; по  умолчанию  результат
десятичный.  Если задан третий аргумент, то он определяет минимальное число цифр в результате.
<p><dt>len  <dd> Возвращает количество символов в своем аргументе.
<p><dt>index <dd> Возвращает  позицию в первом аргументе, с которой
 начинается второй аргумент. Позиции нумеруются  с
 0. В случае неудачи поиска возвращается -1.
<p><dt>substr <dd>     Возвращает подцепочку  первого  аргумента.  Второй
аргумент задает номер начального символа подцепочки (считая от 0), третий аргумент указывает длину.
Если третий аргумент опущен, то подцепочка продолжается  до  конца первого аргумента. Если вторым и
третьим  аргументами  задана подцепочка, выходящая
за пределы данной цепочки, то результатом будет их
пересечение.
<p><dt>translit <dd>     Заменяет в первом аргументе символы, которые  входят во второй  аргумент,  на  символы,  стоящие  в
третьем аргументе на тех же позициях. Не допустимы
никакие сокращения.
<p><dt>include <dd>     Возвращает содержимое файла с именем, заданным аргументом.
<p><dt>sinclude <dd>     То же самое, что и include, за  исключением  того,
что не будет никакой реакции, если  файл  недоступен.
<p><dt>syscmd <dd>     Выполняет команду системы  UNIX,  заданную  первым
аргументом. Никакого значения не возвращается.
<p><dt>sysval <dd>     Код завершения последнего вызова syscmd.
<p><dt>maketemp <dd>     В подцепочку аргумента, имеющую вид XXXXX,  вписывается идентификатор текущего процесса.
<p><dt>m4exit <dd>     Вызывает немедленный выход из m4. Первый аргумент,
если он есть, будет кодом завершения; подразумевается 0.
<p><dt>m4wrap <dd>     Помещает свой первый аргумент в конец исходного
текста, например:
<pre>
	 m4wrap(`cleanup()')
</pre>
Эффективен только один вызов m4wrap, из нескольких
вызовов действие окажет только последний.
<p><dt>errprint <dd>     Выдает свой аргумент в стандартный протокол.
<p><dt>dumpdef <dd>     Выдает текущие имена и определения  для  указанных
макросов, или для всех макросов, если нет аргументов.
<p><dt>traceon <dd>     Если аргументы  не  заданы,  включает  трассировку
всех макросов (в том числе  и  встроенных);  иначе
включает трассировку только указанных макросов.
<p><dt>traceoff <dd>     Выключает трассировку глобально или для  указанных
макросов специально. Если  трассировка  некоторого
макроса была включена вызовом traceon с аргументами, то и выключить его  трассировку  можно  только
вызовом traceoff с именем этого макроса в качестве
аргумента, а не глобальным traceoff  без  аргументов.
</dl>
<p><b>СМ. ТАКЖЕ</b><br>
  <a href=CC.htm>cc(1)</a>, <a href=CPP.htm>cpp(1)</a>.
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
