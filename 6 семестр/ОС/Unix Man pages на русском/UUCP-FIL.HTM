<html>
<head>
<title>uucp-files(5)<br>ОС ДЕМОС. Форматы данных.</title>
		    <style type="text/css">
TH.arial { font-family: Arial, Serif;}
P.topic { font-family: sans-serif;}
A.plain { text-decoration: none;}
A.topic01 { color: #006890;
font-family: sans-serif;
text-decoration: none;}
A.topic02 { color: #099771;
font-family: sans-serif;
text-decoration: none;}
A.topic03 { color: #719709;
font-family: sans-serif;
text-decoration: none;}
A.topic04 { color: #98650A;
font-family: sans-serif;
text-decoration: none;}
A.topic05 { color: #98340A;
font-family: sans-serif;
text-decoration: none;}
A.topic06 { color: #099607;
font-family: sans-serif;
text-decoration: none;}
A.topic07 { color: #9E1215;
font-family: sans-serif;
text-decoration: none;}
A.topic08 { color: #970941;
font-family: sans-serif;
text-decoration: none;}
A.topic09 { color: #950995;
font-family: sans-serif;
text-decoration: none;}
A.topic010 { color: #390A98;
font-family: sans-serif;
text-decoration: none;}
H1 { font-family: sans-serif;}
H2 { font-family: sans-serif;}
H3 { font-family: sans-serif;}
H4 { font-family: sans-serif;}
H5 { font-family: sans-serif;}
H6 { font-family: sans-serif;}
</style>
</head>
<body bgcolor="#FFFFFF" link="#006890" vlink="#003860" alink="#800000" text="#000000">
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/header0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<img src="_pic_/logo.gif" width=157 height=53 border=0 alt="Server for Information Technologies">
</td><td align="right">
<font size="-2">Сервер поддерживается<br><a class="plain" href="http://www.citmgu.ru">Центром Информационных Технологий</a><br>(095) 932-9212, 932-9213, 939-0783<br>E-mail: <a class=noneline href="mailto:info@citmgu.ru?Subject='From page topic CIT FORUM local copy'">info@citforum.ru</a></font>
</td></tr>
</table>
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="left">
<font size="-1">Сервер содержит море(!) аналитической информации</font>
</td><td align="right">
<font size="-1">CIT Forum CD-ROM</font>
</td></tr>
</table>
</td></tr>
</table>

<h3 align=center>uucp-files(5)<br>ОС ДЕМОС. Форматы данных.</h3>
<p><b>НАЗВАНИЕ</b><br>
uucp-files - Описание управляющих файлов UUCP
<p align=justify><b>СПИСОК ФАЙЛОВ</b><br>
<i>Файлы в /usr/lib/uucp (в скобках вариант BSD)</i>
<ul>
Systems (L.sys)- список систем<br>
Devices (L-devices) - список линий и устройств<br>
Dialcodes (L-dialcodes) - список сокращений  телефонов<br>
L-aliases - список псевдонимов<br>
L.cmds  - список разрешенных команд<br>
USERFILE - список разрешенных каталогов, и список соответствия входных имен именам UUCP.<br>
L.shed - управление uusched,<br>
L.dialers - описание модемов для gdial(8)<br>
uucpname - имя локальной системы
</ul>
<i>Файлы в /usr/spool/uucp (в скобках вариант BSD)</i>
<ul>
имя/C.xxxGnnnn - задания UUCP (C./имя/C.xxxxGnnnn)<br>
имя/F.xxxxxx - выходные файлы (F./имя/F.xxxxxx)<br>
имя/D.xxxxxx - принятые файлы (D./D.xxxxxx)<br>
.Xqueue/X.xxxGnnnn - принятые задания для UUXQT (X./X.xxxGnnnn)<br>
.Admin/LOGFILE (LOGFILE) - протокол работы<br>
.Admin/SYSLOG  (SYSLOG)  - статистика
</ul>
<p align=justify><b>ОПИСАНИЕ</b><br>
Настройка системы UUCP осуществляется с помощью  управляющих  файлов.   Они условно делятся на несколько частей:
<ul>
<li>описание  удаленных  систем  и  правил  их   вызова
(Systems, Devices, L.dialers, и другие),
<li>описание прав  доступа  и  защита  от  неправильного
входа в систему - L.cmds и USERFILE,
<li>Описание локальной системы - L.shed, uucpname.
</ul>
<p align=justify><b>ЛОКАЛЬНОЕ ИМЯ СИСТЕМЫ</b><br>
Имя вашей системы UUCP ищет в таком порядке:
<ol>
<li>По значению переменной  UUCPNAME  (используется
для отладки);
<li>в файле /usr/lib/uucp/uucpname,
<li>Если есть сеть TCP/IP,  то  по  сетевому  имени
машины,
<li>Если имя не найдено, используется "unknown".
</ol>
Заметим, что в Xenix файл  /etc/systemid  не  используется.
<p align=justify><b>ОБЩИЕ ПРАВИЛА</b><br>
Все  управляющие  файлы  пишутся  по  общим   правилам.
Строки, начинающиеся с '#', игнорируются (в них пишутся
комментарии). Символ '\' в конце строки  означает,  что
информация  продожается  на  следующей  строке.  Пустые
строки, как правило, игнорируются. Заготовки всех  файлов  содержатся  в  дистрибутиве  (справочник UUAIDS) и
содержат подробный комментарий.
<p>
Далее в именах файлов опущено начало "/usr/lib/uucp".
<p align=justify><b>ФАЙЛ Systems</b><br>
Файл  /usr/lib/uucp/Systems   (L.sys)   описывает   ВСЕ
известные  системе  UUCP  имена.  Каждая  строка  в нем
содержит следующие поля, разделенные пробелами:
<ol>
<li>имя системы,
<li>время вызова [/приоритет][;Recall_time]
<li>тип устройства[,параметры-протокола]
<li>класс и скорость[,нужные атрибуты]
<li>Адрес (телефон) и атрибуты вызова,
<li>Алгоритм входа в удаленную систему
<li>-- // -</ol>
Поля 3-6 могут отсутствовать, если система  никогда  не
вызывается.
<p align=justify>
Файл Systems используется  для  проверки,  известна  ли
машина  системе  UUCP,  и  для исходящих вызовов других
машин.  Подробное описание и примеры приведены ниже.
<p align=justify><b>ФАЙЛ USERFILE</b><br>
Этот файл описывает права доступа разных  машин  к  тем
или  иным справочникам, а также  их право на выполнение
команд того или иного класса (см. ниже L.cmds), и соответствие  между  именем  входа  (login-name)  и  именем
машины.  Строки в нем имеют формат:
<pre>
 login-name,uucp-name [-Xкласс] [список_справочников]
</pre>
где пара login-name и uucp-name определяет допустимость
появления  машины  'uucp-name' под именем 'login-name',
'класс'  определяет  максимальный   класс   разрешенных
команд,  'список_справочников'  определяет  те справочники, доступ к которым разрешен машине 'uucp-name'.
<p>
Кроме того, в этом файле могут быть такие записи:
<pre>
 ,local список_справочников
</pre>
определяет   список   справочников,    которые    могут
указываться  в команде 'uucp' выполняемой любым локальным пользователем,
<pre>
 login-name,local список_справочников
</pre>
определяет,  какие  справочники   может   читать/писать
локальный пользователь  'login-name' с помошью UUCP,
<pre>
 any, список_справочников
</pre>
определяет права произвольной машины (по умолчанию).
<p align=justify><b>ФАЙЛЫ Dialcodes и L.aliases</b><br>
Файл 'Dialcodes' (L-dialcodes в варианте BSD)  содержит
символьные обозначения номеров телефонов, например:
<pre>
 MOSCOW 8=812
</pre><p align=justify>
Файл 'L.aliases'  содержит  описание  псевдонимов,  что
позволяет вместо одной UUCP машины ссылаться на другую.
Например:
<pre>
 demos fuug
</pre><p align=justify>
означает, что  все, что предназначено для 'fuug',  надо
отправлять  на  demos. (Пример взят с kiae!, на котором
иностранные письма маршрутизировались  на  'fuug',  но,
так как с 'fuug' работал 'demos', реально посылались на
'demos').
<p align=justify><b>uustartup</b><br>
Это программа, которая вызывается после успешного  соединения  c удаленной машиной, с единственным аргументом
- именем этой машины.  Она пишется администратором системы  UUCP  в случае, если необходимо сбросить какие то
буфера (например, batchmail). Например, на 'kiae!'  эта
программа на 'csh' имеет вид:
<pre>
 #! /bin/csh -f
 if ( $1 == demos ) then
   batchmail -f fuug
 endif
 batchmail -f $1
</pre>
<p align=justify><b>ОПИСАНИЕ МАШИНЫ, ВЫЗЫВАЮЩЕЙ ЛОКАЛЬНУЮ</b><br>
Для того, чтобы другая система могла общаться  с  вашим
UUCP, вызывая его по телефону, прямой линии или TCP/IP,
она должна быть описана в файлах  "Systems"  (L.sys)  и
"USERFILE".
<p align=justify>
Прежде всего,  для  машины  'uucp-name'  заводится  имя
пользователя,    пароль,    а    в   качестве   shell-a
устанавливается   /usr/lib/uucp/uucico.   Например,   в
/etc/passwd соответствующая запись может иметь вид:
<pre>
 uualex:xcsSGAKWYFG:5:5:alex.kiae.su:/usr/spool/uucp:/usr/lib/uucp/uucico
</pre>
Машина 'имя' заводится в /usr/lib/uucp/Systems (L.sys).
Формат описания:
<pre>
 имя incoming
</pre>
В /usr/lib/uucp/USERFILE пишется строка:
<pre>
 login-name,имя [-Xкласс] список_справочников
</pre><p align=justify>
Если параметр -X. опущен, считается, что данная система
может выполнять команды класс '0'.
<p align=justify>
Если файл L.cmds уже заведен ранее, и содержит описание
всех  необходимых  команд,  то на этом заведение машины
'имя' кончается.
<p align=justify><b>ОПИСАНИЕ УСТРОЙСТВ ВЫЗОВА</b><br>
Если ваша система должна вызвывать другие машины  сама,
то  прежде  всего  необходимо  описать  все устройства,
которые используются для вызова. В случае TCP/IP  такое
описание  не требуется, терминальные линии же описывают
в  файле  /usr/lib/uucp/Devices   (L-devices).   Каждая
запись этого файла имет вид:
<pre>
 Caller Line Useful Class Dialer [Chat ...]
</pre>
где
<dl>
<dt>Caller
<dd>Тип программы вызова. ACU - линия, подключенная
к модему, DIR - линия подключена напрямую.  (На
самом деле тип определяется первыми тремя  символами,   а  остальные  просто  сравниваются  с
третьим полем в файле  Systems)  За  ним  через
запятую   может  следовать  приписка  -  список
допустимых протоколов, например: ACU,gf.
<dt>Line
<dd>Имя устройства (без начального '/dev/'), например,  'tty01'.   В  Xenix-е  описывают  линию с
модемным контролем (tty1A, ...).
<dt>Useful
<dd>Это поле не используется в данной  версии  системы. Обычно там ставится '-'.
<dt>Class
<dd>[Класс]Скорость_линии[,Допустиме_атрибуты].
'Класс' - это любой символьный (без цифр) префикс, означающий тот или  иной  класс  телефона
(внутренний, городской, Искра-2, ...), он сравнивается с классом,  указанным  в  поле  класса
файла Systems. Скорость обозначает ту скорость,
на которой нужно обращаться к модему, она сравнивается со скоростью, указанной в поле 'Класс'
файла Systems.  'Атрибуты'  представляют  собой
набор  букв  и  цифр  (отделенный запятой). Для
того,  чтобы  система  воспользовалась   данной
линией, все атрибуты, указанные в соответствующем поле файла Systems, должны иметься в списке
атрибутов терминальной линии.
<dt>Dialer
<dd>Это или имя модема,  описанное  далее  в  файле
L.dialers (в этом случае для набора номера UUCP
вызывает программу 'gdial'), либо  начинаюшееся
со '/' имя программы-диалера. Программа вызывается с параметрами:
<pre>
    Dialer [-xN] номер:опции /dev/линия скорость
</pre>
и должна возвращать  стандартные  коды  ответа,
описанные в диалере 'gdial'.
<dt>Chat
<dd>Оставшиеся аргументы передаются диалеру, причем
если  аргумент один, то он подставляется в поле
номера телефона (предварительно T заменяется на
номер из файла Systems). Если аргументов больше
одного, то они трактуются как аргументы  вызова
диалера (вместо стандартных).
</dl><p align=justify>
Атрибуты модема трактуются произвольно,  но  рекомендуется использовать хотя бы следующие:
<ul>
<li><b>O</b> - выходная линия (по которой можно звонить),
<li><b>I</b> - по линии можно звонить на межгород,
<li><b>F</b> - по линии можно звонить за рубеж,
<li><b>v</b> - модем имеет V42bis
<li><b>m</b> - модем имеет MNP протокол,
<li><b>9</b> - модем имеет протокол V32,
<li><b>p</b> - модем имеет протокол PEP.
</ul>
Примеры описаний:
<pre>
 DIR     tty31   -  19200        vax
 ACU     tty01   -  IAE9600,Om   Disco2400-MNP
</pre>
<p align=justify><b>ОПИСАНИЕ ВЫЗЫВАЕМОЙ МАШИНЫ</b><br>
Машина, которую  надо  вызывать,  описывается  в  файле
Systems.   В  этом файле должна быть одна или несколько
строк, описывающих алгоритм и  правила  вызова.  Строки
имеют формат:
<pre>
 Имя  Время  Тип_вызова  Класс_устройства  Адрес_машины
Send Expect ...
</pre>
<dl>
<dt>Имя
<dd>Имя вызываемой машины. Если в  файле  несколько
строк  с  одним  именем, они просматриваются (и
выполняется попытка вызова) последовательно  до
тех  пор,  пока  не  кончится  файл Systems или
связь не установится.
<dt>Время
<dd>Допустимое время вызова. В этом же поле записывается  приоритет  (Grade) и максимальное время
запрета связи после  сбоя.  Время  может  иметь
вид:
<ul>
<li>Never - система никогда не вызывается,
<li>ДниЧасы - в указанные дни  вызов  в  указанные
чаcы,
</ul>
Допустимые дни:
<ul>
<li>Any - вызов в любое время
<li>Su Mo Tu We Th Fr Sa - вызов в  указанные  дни
недели (воскресенье - суббота),
<li>Wk - рабочий день недели,
</ul>
Часы записываются в виде ЧасовМинут-ЧасовМинут.<br>
Примеры записи времени:
<pre>
     Any
     SaSu0100-0700
     MoTuWeThFrSa1900-0700
</pre>
(Заметим, что естественным образом пишется диапазон  времени,  переходящий  через  0).  Можно
повторять запись, разделяя ее вертикальной чертой, например:
<pre>
     MoTuWeThFrSa1900-0700|SaSu0000-2400
</pre>
В этом же поле можно указать максимальный приоритет  (Grade)  выполняемых  в  указанное время
заданий - /Grade. Кроме того, через ',' или ';'
можно  указать  максимальное  время  запрета на
повторный вызов. Дело в том, что по  умолчанию,
послу  сбоя  соединения  система  устанавливает
временный запрет на связь с удаленной  машиной,
чтобы  предотвратить  пустую  трату телефонного
времени в случае, если  сбой  вызван  какой  то
неустранимой   причиной  (например,  та  машина
стоит). Это  время  растет  экспоненциально  от
сбоя  к  сбою  - 5 минут, 10 минут, 20 минут, и
так далее.  Если  вы  предполагаете,  что  сбои
вызываются  случайными причинами, или вам нужно
во что бы то ни было устанавливать связь, имеет
смысл  ограничить этот интервал сверху. Записывается это так (например):
<pre>
     Any;5
     SaSu0000-2400;50
</pre>
В этом случае время  запрета  не  будет  больше
указанного в строке.
<p>
Итак,  допустим,  вы  хотите  вызывать   машину
'kiae'  в  любой  день недели, причем в рабочие
дни в дневное время запретить передачу и  прием
новостей, которые идут (допустим) с приоритетом
'd', и не допускаете, что машина в  kiae  может
простаивать  больше  15 минут. Тогда вы делаете
такую запись в поле времени:
<pre>
     Wk0900-1800/Z;15|Any/z;15
</pre>
Наиболее распространена запись вида:
<pre>
     Any или Any;15
</pre>
<dt>Тип
<dd>Это поле описывает программу, которая используется  для вызова.  Тут же указываются локальные
и удаленные протоколы и их параметры настройки.
Основные типы связи:
<p>
TCP - вызов по TCP/IP. В этом  случае  в  поле
КЛАСС  записывается  номер  порта  сервера UUCP
(обычно 'uucp' или  '540'),  в  поле  адреса  адрес машины в TCP/IP, например:
<pre>
 kiae Any TCP uucp  relcom.kiae.su  login:  имя
word: пароль
</pre>
DIR - вызов по постоянно включенной  линии.  В
этом  случае  в  поле  адреса  пишется имя устройствва (без /dev/), на которое  включена  эта
линия  (оно  должно  быть описано в Devices как
'direct'):
<pre>
 kiae Any;5 DIR 9600 tty24 .......
</pre>
ACU - вызов через модем. В этом случае в  поле
адреса  пишется номер телефона и атрибуты настройки модема. Например:
<pre>
 kiae Any;15 ACU 9600,Om 9469994:mnp ........
</pre>
В этом же поле  (тип  программы  вызова)  можно
указывать  протокол  работы и параметры локального и удаленного протоколов. Протоколы отделяются   от  типа  запятой,  удаленные  протоколы
пишутся после '/'. Примеры:
<ul>
<li>ACU,f - работать по 'f' протоколу
<li>ACU,g(3,128) - установить окно 3 и  пакет  128
на прием, работая по 'g' протоколу,
<li>ACU,g(3,256)/(5,128)  -  установить  на  своей
машине  (на  прием)  окно  3  и  пакет  256, на
удаленной машине запросить окно 5 и  пакет  128
(при передаче на нее).
</ul>
Аналогично протокол можно указывать и в  случае
TCP или DIR.
<p>
(На самом деле, программа  вызова  определяется
по первым 3-м буквам, так что можно писать, как
и в HDB UUCP: ACUKIAE. Полное название ищется в
Devices при определении линии для вызова).
<dt>Класс_устройства
<dd>В случае TCP тут пишется,  как  правило,  слова
'uucp'  или  номер порта 540.  В случае ACU или
DIR в этом поле указываются:
<pre>
 Категория линии (префикс, состоящий из букв),
 Скорость линии (может быть '*'),
 Требуемые атрибуты линии (модема)
</pre>
Категория линии определяет те  строки  Devices,
которые  будут  рассматриваться  - их категории
должны совпадать. Скорости также должны  совпадать,  за  исключением  случая, когда в Systems
стоит '*' - тогда на  самой  линии  может  быть
любая  скорость.  Атрибуты (отделяются запятой)
сравниваются с атрибутами линий в Devices - все
атрибуты  из  Systems должны иметься в описании
линии в Devices. Примеры:
<p>
WCKS19200,p - линия сети ВЦКС, скорость  порта
19200, требуется протокол PEP.
<p>
На самом деле все эти характеристики условны, а
система просто ищет в Devices строку, в которой
в поле Класс написано:
<pre>
 WCKS19200,[что-угодно]p[что-угодно]
</pre>
Еще пример - описание системы  fuug  на  машине
kiae:
<pre>
 fuug Any;5 ACU,g(7,64) 19200,Fp ....
</pre>
А в файле Devices принято обозначать  атрибутом
'F' линии, по которым можно звонить за рубеж, а
'p' - модемы с протоколом 'PEP'.  Например:
<pre>
 ACU     tty18   -  19200,FOIpv9m   T2500
</pre>
<dt>Адрес
<dd>В случае ACU это - номер телефона,  за  которым
могут  через ':' идти параметры настройки настройки модема. Это поле просто  передается  диалеру.  Универсальный диалер 'gdial' (работающий
через  L.dialers)  понимает  параметры   модема
согласно  описанию  модемов.  В системе принято
использовать параметры (в принципе  это  просто
соглашение об использовании L.dialers):
<pre>
 :mnp - MNP
 :comp - компрессия
 :v42  - V42bis
 :v32  - V32
 :pep  - протокол PEP
 :xon  - использование XON/XOFF
</pre>
Кроме того, символ '=' означает 'ждать  гудка',
а  '-'  - пауза.  Перед номером может идти символьный префикс - код города,  который  заменяется  на номер телефона в соответствии с файлом
'Dialcodes'.   В  случае  TCP  в  поле   адреса
пишется адрес машины в TCP/IP, а в случае DIR сокращенное (без '/dev/') имя устройства.
<dt>'Expect/Send'
<dd>Остальная часть строки описывает алгоритм входа
в  удаленную  систему  - пары строк 'Send' (что
надо сказать удаленной системе) и  Expect  (что
она   должна   ответить).   Первым   идет  поле
'Expect'.  По сути в ней  описывается  то,  что
делает  пользователь для входа в удаленную систему, например:
<ul>
<li>Ждать слова 'login:'
<Li>если не дождался, нажать 'Enter'
<li>на 'login:'  ввести  'uualex',  затем  ждать
'Password:',
<li>Получив 'Password:' , ввести пароль.
</ul>
Аналогично выглядит и запись в Systems. В полях
'Send'  описывается  посылаемый  текст, а также
можно   указывать   смену   четности,   посылку
 'Break',  установку  времени ожидания и многое
другое. В полях  'Expect' можно указывать  альтернативные  пары 'Send/Expect'. Точно все выглядит так:
<dt>'Send'
<dd>В поле 'Send' записывается произвольный  текст,
который  нужно послать.  Особым образом понимаются пары символов '\C', кроме того, существуют
специальные значения поля Send, которые трактуются специальным образом:
<ul>
BREAK - послать в линию 'Break',<br>
PAUSEN - пауза в N секунд,<br>
P_ZERO - установить нулевой бит четности,<br>
P_EVAN - установить четность в 'EVEN',<br>
P_ODD - установить четность в 'ODD',<br>
P_ONE - установить бит четности в 1
</ul>
По умолчанию стоит 'P_ZERO'. Все эти  слова  не
вызывают только то действие, которое описывают,
и не посылают в линию никаких символов.
<p>
Имеется несколько 'Escape' последовательностей,
понимаемых особым образом:
<ul>
\c - не  выдавать  CR  (символ  015)  в  конце строки,<br>
\r - символ 015 (CR),<br>
\n - символ 012 (NL)<br>
\d - пауза в 2 секунды,<br>
\s - пробел<br>
\bN - посылать 'BREAK' N секунд,<br>
\NNN - символ с кодом NNN.
</ul>
Кроме того, "" означает 'послать CR'.
<p>
Поле 'Expect' имеет один из двух форматов:
<pre>
 Expect
 Expect-Send1-Expect1...
</pre>
Во  втором  случае,  если   не   пришел   ответ
'Expect',   посылается   'Send1'   и  ожидается
'Expect1', и так далее.
<p>
В строке 'Expect' могут также указываться
<ul>
<li>\NNN - означает символ 0NNN,
<Li>\b - пробел,
<li>~NNN - установить  время  ожидания  в  'NNN'
секунд, данная запись должна быть в самом конце
'Expect'.
<li>"" - если это отдельное  поле  'Expect',  то
означает 'Ничего не ждать'.
</ul>
Примеры:<br>
<i>Systems:</i>
<pre>
 kiae  Any;15  ACU  2400  9469984  ogin:--ogin:
uualex assword:-uualex-asswprd: uuXYZ
</pre>
<i>Строка в Devices:</i>
<pre>
 ACU tty1A - 9600 SmartOne
</pre>
Это был простейший вариант.  Вот более сложный:<br>
<i>Systems:</i>
<pre>
 kiae Any;15  ACU,g(3,256)/g(4,128)  ISKRA*,Im2
MOSCOW9469994:mnp:long \
 ""  P_ZERO   ogin:~6--ogin:-BREAK-ogin:--ogin:
\d\025uualex \
 assword:~65-\d\025uualex\r\c-assword:
 25XYZpasswd 7
</pre>
<i>Devices:</i>
<pre>
 ACU acu00 - ISKRA19200,IOmv921 Case4696r

Dialcodes

 MOSCOW 8=852</pre>
В последнем случае в  классах  устройств  буквы
трактуются как:<br>
I - межгород, O -  выходная,  m  -  MNP,  v  V42bis, 9 - V32, 2 - V22bis, 1 - V22. Но  это  личное  дело  администратора
системы.
</dl>
<p align=justify><b>ТОНКОСТИ НАСТРОЙКИ</b><br>
При описании вызываемой машины необходимо  предусматривать следующее:
<ol>
<li>Если вызов идет по  межгороду,  то  значительно
увеличивается   время   ожидания  соединения  и
уменьшается вероятность соединения. Для улучшения  соединения обычно увеличивают время ожидания в описании модема (можно даже  завести  для
такого  соединения отдельную строку в Devices и
отдельное описание диалера), увеличивают  время
ожидания  самого  модема (переменная S7, обычно
устанавливается по опции 'long')  и  записывают
несколько  копий  строки  с  описанием  в файле
'Systems'.
<li>После соединения  'login:'  выдается  удаленной
стороной далеко не всегда.  Иногда нужно выдать
один (или  несколько)  символов  'CR'  (клавиша
'Enter'), чтобы получить 'login:'.
<li>В некоторых системах выдается 'Login:' и 'Password:', в других - 'login:' и 'password:'. Поэтому ждут обычно не  'login:',  а  'ogin:',  не
обращая внимания на первый символ.
<li>Бывает  полезно  стереть  буфер   терминального
драйвера перед выдачей имени или пароля, в этом
случае пишется что то вроде '\025uualex
</ol>
<p align=justify><b>ПРОВЕРКА</b><br>
Для  проверки  вызова     uucico  вызывается  в  режиме
отладки.    Полезно   бывает   проверить   правильность
'Systems', взяв какой  либо  'kermit'  и  проверив  все
'Expect/Send',  посылая  их  вручную.   Причиной ошибки
может быть неверная четность  посылаемого  текста,  или
неверный символ стирания буфера (символ '025' во многих
System-V не стирает буфер при вводе имени или пароля).
<p align=justify><b>ОПИСАНИЕ ДОПУСТИМЫХ КОМАНД И СПРАВОЧНИКОВ</b><br>
Следующий этап описания любой системы - это обеспечение
необходимых ограничений для нее. Для этого служат файлы
USERFILE и L.cmds.
<p align=justify>
Файл  L.cmds  содержит  список  команд,  которые  могут
выполнять  удаленные  машины, с [возможно] указанием, к
какому классу UUCP должны  принадлежать  машина,  чтобы
выполнять данную команду, описание того, нужно ли посылать ответ и в каких случаях, и  описание  пути  поиска
команд (PATH). Файл может содержать следующие строки:
<p align=justify>
Описание пути поиска команд:   PATH=путь_поиска_команд,
например:
<pre>
 PATH=/bin:/usr/bin:/usr/ucb:/usr/local/bin
</pre><p align=justify>
Описание того класса, к  которому  относятся  следующие
команды: X=класс, где класс - число от 0 до 9,
<p align=justify>
Описание команды в формате: команда[,[Error][No]], например:
<pre>
 rmail,Error
 rbmail,No
 rnews,Error
 rsend
</pre><p align=justify>
По  умолчанию  uux  шлет   уведомление   о   выполнении
команд.Суффикс 'No' блокирует это послание во всех случаях, суффикс  'Error'  -  оставляет  только  в  случае
ошибки.
<p>
Пример файла:
<pre>
 PATH=/bin:/usr/bin:/usr/ucb:/usr/local/bin
 rmail,Error
 rbmail,No
 X=2
 rnews,Error
 X=4
 rsend
 X=9
 who
 lpr
</pre><p align=justify>
Второй файл, в котором надо описывать права  доступа  USERFILE.  Формат его упоминался в выше. В нем указывается:
<pre>
 login-name,uucp-name [-Xкласс] список_справочников
</pre><p align=justify>
При выполнении  команды  проверяется,  что  класс  этой
команды  не выше класса данной uucp машины. В приведенном выше примере для выполнения команды  'lpr'  машиной
'alex' в файле должно стоять что то вроде:
<pre>
 uualex,alex -X9 /usr/spool/uucppublic
</pre>
<p align=justify><b>ОПИСАНИЕ МОДЕМОВ (L.dialers)</b><br>
Как правило, для работы с модемами используется внешний
диалер   (в  системе  есть  встроенные  имена  'hayes',
'hayes2400' - для вызова по правилам работы с совместимыми  с  Hayes модемами, но они совершенно не учитывают
специфику конкретного модема). Если в описании  Devices
указан  тип модема, отличный от известного 'uucico' (то
есть от 'hayes' или 'hayes2400'), то вызывается универсальный  диалер, который берет описание модема из файла
'/usr/lib/uucp/L.dialers'. Параметры вызова этого  диалера описана в 'gdial(8)'.
<p>
В файле L.dialers описано все, что нужно для <ul>
<li>инициализации модема (ключ '-z' команды 'gdial'),
<li>соединения с указанным номером,
<li>установки модема в режим приема звонков (ключ '-h').
</ul>
Файл L.dialers состоит из ряда описаний модемов. Каждое
описание начинается с указания:
<pre>
 Modem=Тип_модема
</pre>
и кончается строкой, состоящей из точки:
<p align=justify>
Строки, начинающиеся с #, игнорируются (еще   до  обработки символа '').
<p align=justify>
Параметры модема описываются записями вида:
<pre>
 Имя=Значение
</pre>
или
<pre>
 Имя=Значение Значение ...
</pre><p align=justify>
В первом случае на одной строке  могут  быть  несколько
описаний, во втором - список значений, разделенных пробелами, занимает весь остаток строки, и,  если  нуобходимо,  может  быть  продлен на следующие строки, если в
конце строки стоит '\'. При этом символ \ не рассматривается  как  пробел.   Можно использовать одиночные или
двойные кавычки, так, что, например,
Start" '01'" представляет собой  одно  слово.   Имена
переменных  могут  сокращаться  до  2-х  букв, если это
обеспечивает однозначное распознавание.
<table>
<tr><td colspan=4>Список переменных (* - обязательно описание, ! - значение - массив)</tr>
<tr><td>Modem<td>*<td><td>имя модема в системе</tr>
<tr><td>Use<td>*<td><td>имя модема - аналога, его описание</tr>
<tr><td>Hang<td>*<td>!<td>Как оборвать связь (в формате Send Expect, см. ниже)</tr>
<tr><td>Save<td><td>!<td>Инициализация ПЗУ модема (Send Expect)</tr>
<tr><td>Call<td>*<td>!<td>Вызов (Send Expect)</tr>
<tr><td>Host<td><td>!<td>Перевод в режим ожидания звонка (Send Expect)</tr>
<tr><td>Reset<td><td>!<td>Сброс модема при каких либо  трудностях (Send Expect)</tr>
<tr><td>Valid<td><td><td>Символы,  допустимые  в   номере</tr>
</table>
<p>Ответы модема:
<p><table>
<tr valign=top><td>Connect <td>!<td>Возможные ответы модема при соединении</tr>
<tr valign=top><td>Busy<td>!<td>Ответы, означающие занятость телефона</tr>
<tr valign=top><td>Nocar<td>!<td>Ответы - нет несущей</tr>
<tr valign=top><td>Error<td>!<td>Ответы - ошибка команды модема</tr>
<tr valign=top><td>Ring<td><td>Ответ - опознан входящий звонок</tr>
<tr valign=top><td>Rring<td><td>Ответ - опознан звонок на удаленном модеме</tr>
<tr valign=top><td>Baud<td>!<td>Список допустимых  скоростей работы  с  модемом (не путать со скоростью связи)</tr>
<tr valign=top><td>Chars<td><td>Строка замены символов в номере вида:<br>-&lt;Символ задержки&gt;=&lt;Символ ожидания гудка&gt; (например, -,=W)</tr>
<tr valign=top><td>Tconn<td><td>Время (в секундах),  отводимое на соединение</tr>
<tr valign=top><td>Trring<td><td>Время, отводимое на соединение после приема первого удаленного звонка (Rring)</tr>
<tr valign=top><td>Tmodem<td><td>Время на ожидание ответа после команды модема</tr>
<tr valign=top><td>Tdigit<td><td>Время, добавляемое при вызове на каждую цифру</tr>
<tr valign=top><td>Tpause<td><td>Время, добавляемое на  паузу (символ '-' в номере)</tr>
<tr valign=top><td>Twait<td><td>Время, добавляемое на ожидание гудка</tr>
</table>
<p align=justify>
Далее следует описание опций. Опции включаются в  номер
в L.sys через двоеточие и вызывают дополнительную настройку модема при выполнении его команд (см. O в  описании Send ниже).
<pre>
 Options=название подставить  название подставить ...
</pre><p align=justify>
где название - название опции (mnp, ...) подставить - команды модема, которые  подставляются  вместо  O  в  строке,  посылаемой на модем (!!! в
строке 'подставить' обратный  слеш  не  удваивается,  в
отличие  от  'Send')  Имена  опций произвольны, но есть
рекомендованные стандартные  имена  (в  зависимости  от
категории Acu в L.devices):
<ul>
 Все - puls, tone, - импульсный или тоновый набор<br>
 ans1, ans2, ans3 - отвечать на 1-й, 2-й, 3-й звонок<br>
 norb - выключить распознавание BUSY и других  сигналов
M (модем с МНП)<br>
 mnp, nr - МНП или без МНП (по умолчанию д. быть  режим
автоматического распознавания<br>
 dir     - прозначный режим<br>
 comp, nocomp - включение / выключение компрессии<br>
 v42 - режим v42 (mnp его выключает)<br>
 xon, rts, noflc - управление контролем передачи
</ul>
Любой модем - скорости связи:
<pre>
 v32, b2400, b1200, b300, bany
</pre><p align=justify>
Переменные в формате Send /  Expect  описывают  команды
модему и ожидаемые ответы в форме:
<pre>
 Послать Ждать Послать Ждать ...
</pre>
Причем Ждать может иметь форму
<pre>
 Ждать-Послать1-Ждать1...
</pre><p align=justify>
аналогично файлу Systems в описании систем UUCP.  (Если
Ждать  не  получен,  послать  строку  Послать1  и ждать
ответа Ждать1, и так далее. Правила записи  строк  Послать и Ждать:
<p align=justify>
<i>Ждать</i> если отсутствует последнее поле Ждать в  строке
"Call", то система ждет ответа в соответствии с
переменными Conn, Busy, Nocar и т.д.
<p align=justify>
если строка Ждать начинается с пробела  ("  *",
например),  то ответ ищется, не дожидаясь получения символа LF  (перевод  строки)  с  модема.
Пробел  при  этом  пропускается.  Иначе сначала
система ждет получения символа перевода строки,
а затем уже сравнивает полученную строку с возможными ответами.   Пробелы  в  ответах  модема
игнорируются,
<p align=justify>
<i>Послать</i> в строке "Послать" распознаются следующие  специальные последовательности:
<ul>
 \\ - заменяется на \<br>
 \r - заменяется на символ возврата каретки<br>
 \n - заменяется на символ перевода строки<br>
 \c - означает - не добавлять 7 в  конец  Send (что делается по умолчанию).<br>
 \s - заменяется на пробел<br>
 \d - задержка на 2 секунды<br>
 \BN - послать BREAK в линию  на  N  секунд  (B эквивалентно B3)<br>
 \DN - снять DTR на N секунд   (D  эквивалентно D2)<br>
 \wN  -  установит  время  ожидания  очередного ответа N секунд<br>
 \T  -  подставить  сюда  номер  телефона  (при вызове)<br>
 \O  - подставить сюда строку,  сгенерированную указанными в вызове опциями<br>
 \nnn - символ с кодом nnn
</ul>
Маленькие правила <ul>
 В строке Send символ \\ удваивается<br>
 При описании опций и в Expect \ не удваивается<br>
 Чтобы написать \ в конце строки, его заменяют на '\'.
</ul>
<p align=justify>
Для описания нового модема в этом  файле  рекомендуется
найти описание похжего модема, сослаться на него и описать только те характеристики, которые отличаются.
<p align=justify><b>СТАТИСТИКА И ЧИСТКА КАТАЛОГОВ</b><br>
Система UUCP пишет несколько файлов статистики и протоколов работы.
<p align=justify>
<i>Протокол</i><br>
Протокол    работы    системы     пишется     в
'/usr/spool/uucp/.Admin/LOGFILE'  (в  BSD варианте - в /usr/spool/uucp/LOGFILE). Можно сгенерировать  систему так, чтобы статистика по каждой машине и от каждой команды системы писалась
отдельно, но обычно это не делается для упрощения просмотра протоколов. В протокол пишутся:
<ul>
<li>имя пользователя, под которым  работает  программа,
<li>имя машины, к которой относится операция,
<li>дата, время и номер процесса,
<li>текст сообщения.
</ul>
например:
<pre>
 alex kiae1 (3/20-23:19-15009) XQT QUE'D (who)
</pre>
<p align=justify><b>СТАСТИСТИКА UUCP</b><br>
При передаче и приеме файлов UUCP пишет статистику   в  файл  '/usr/spool/uucp/.Admin/SYSLOG'
(/usr/spool/uucp/SYSLOG в варианте BSD). В каждой строке записываются:
<pre>
 имя пользователя,
 имя машины,
 (дата, время, номер процесса),
 (точное время )
 операция (send/received data),
 длина файла
 время передачи
 возможно, число повторов по таймеру.
</pre><p align=justify>
Эта    статистика    обрабатывается    командой
'uurate',  которая  подсчитывает  объемы и скорость передачи данных.
<p>
Пример записи:
<pre>
 alex altserv (3/20-19:10) (701107844.15)  sent
data 1228800 bytes 2306.64 secs 45 retries
</pre>
<p align=justify>
<b>Протокол</b><br>
При  вызове  UUCP  в  пассивном  режиме  (через
'login:'),  если  на  удаленном  конце включена
отладка (-xN), uucico пишет отладочну/ информацию    в    файл    '/usr/spool/uucp/.Audit/имя
(/usr/spool/uucp/AUDIT/имя  в  варианте   BSD).
Каждый  раз  этот файл начинается заново. Рекомендуется стирать из этого  справочника  файлы,
пролежавшие   больше   суток   (что   и  делает
uu.daily).
<p align=justify>
Ежедневно должна запускаться программа очистки и  сбора
статистики.      Эта     программа     (как    правило,
/usr/lib/uucp/uu.daily)  уничтожает  задания  и  файлы,
которые не смогли выполниться за указанное в ней время,
а затем, если имеется справочник '/usr/spool/uucp/.Old'
(/usr/spool/uucp/OLD  в  варианте  BSD) собирает на помесячной основе протокол и статистику  работы,  а  если
такого  справочника  нет,  просто  сохраняет последовательно статистику и  протоколы  за  7  последних  дней.
Подробнее она описана в <a href=UU-DAILY.htm>uu-daily(8)</a>.
<p><b>СМ. ТАКЖЕ</b><br>
uudaily(8), gdial(8), <a href=UUCICO.htm>uucico(8)</a>, <a href=UUXQT.htm>uuxqt(8)</a>,  "Замечания
по реализации UUCP".
<table cellspacing=0 cellpadding=0 border=0 background="_pic_/footer0.jpg" width="100%">
<tr><td align="center">
<table cellspacing=0 cellpadding=4 border=0 width="100%" background="">
<tr><td align="right" valign="top" width="33%">
<font size="-2">Comments: <a class="plain" href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM local copy'">info@citmgu.ru</a><br>
Designed by <a class="plain" href="mailto:andrey@novikov.com">Andrey Novikov</a><br>
Copyright &copy; <a class="plain" href="http://www.citmgu.ru/">CIT</a></font>
</td></tr>
</table>
</td></tr>
</table>
</body>
</html>
